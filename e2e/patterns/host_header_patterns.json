{
  "metadata": {
    "category": "host_header",
    "total_patterns": 21,
    "port": 80,
    "description": "k6 test patterns for Host Header Injection attacks",
    "phase": "Phase 11"
  },
  "patterns": [
    {
      "id": "HHI_XFH_001",
      "name": "X-Forwarded-Host redirect",
      "category": "host_header",
      "subcategory": "open_redirect",
      "payload": "X-Forwarded-Host: evil.com",
      "encoded": "X-Forwarded-Host%3A%20evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_XFH_002",
      "name": "X-Forwarded-Host password reset",
      "category": "host_header",
      "subcategory": "open_redirect",
      "payload": "X-Forwarded-Host: evil.com/reset",
      "encoded": "X-Forwarded-Host%3A%20evil.com%2Freset",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_XH_001",
      "name": "X-Host injection",
      "category": "host_header",
      "subcategory": "host_injection",
      "payload": "X-Host: evil.com",
      "encoded": "X-Host%3A%20evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_XH_002",
      "name": "X-Original-Host injection",
      "category": "host_header",
      "subcategory": "host_injection",
      "payload": "X-Original-Host: evil.com",
      "encoded": "X-Original-Host%3A%20evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_CRLF_001",
      "name": "CRLF Host injection",
      "category": "host_header",
      "subcategory": "crlf_host",
      "payload": "\\r\\nHost: evil.com",
      "encoded": "%0d%0aHost%3A%20evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_CRLF_002",
      "name": "CRLF X-Forwarded-Host injection",
      "category": "host_header",
      "subcategory": "crlf_host",
      "payload": "\\r\\nX-Forwarded-Host: evil.com",
      "encoded": "%0d%0aX-Forwarded-Host%3A%20evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_FWD_001",
      "name": "Forwarded header host",
      "category": "host_header",
      "subcategory": "forwarded_header",
      "payload": "Forwarded: host=evil.com",
      "encoded": "Forwarded%3A%20host%3Devil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_FWD_002",
      "name": "Forwarded header with proto",
      "category": "host_header",
      "subcategory": "forwarded_header",
      "payload": "Forwarded: host=evil.com;proto=https",
      "encoded": "Forwarded%3A%20host%3Devil.com%3Bproto%3Dhttps",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_ENC_001",
      "name": "Double-encoded X-Forwarded-Host",
      "category": "host_header",
      "subcategory": "double_encoded",
      "payload": "X-Forwarded-Host%3A evil.com",
      "encoded": "X-Forwarded-Host%253A%20evil.com",
      "port": 80,
      "expected_detection": false,
      "severity": "medium",
      "expected_rule": "NONE"
    },
    {
      "id": "HHI_ENC_002",
      "name": "Double-encoded CRLF Host",
      "category": "host_header",
      "subcategory": "double_encoded",
      "payload": "%0d%0aHost%3A evil.com",
      "encoded": "%250d%250aHost%253A%20evil.com",
      "port": 80,
      "expected_detection": false,
      "severity": "medium",
      "expected_rule": "NONE"
    },
    {
      "id": "HHI_CACHE_001",
      "name": "X-Forwarded-Host cache poisoning",
      "category": "host_header",
      "subcategory": "cache_poisoning",
      "payload": "X-Forwarded-Host: evil.com",
      "encoded": "X-Forwarded-Host%3A%20evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_CACHE_002",
      "name": "X-Host cache poisoning",
      "category": "host_header",
      "subcategory": "cache_poisoning",
      "payload": "X-Host: evil.com",
      "encoded": "X-Host%3A%20evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_RESET_001",
      "name": "X-Forwarded-Host password reset hijack",
      "category": "host_header",
      "subcategory": "password_reset",
      "payload": "X-Forwarded-Host: evil.com/reset-password",
      "encoded": "X-Forwarded-Host%3A%20evil.com%2Freset-password",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_SSRF_001",
      "name": "X-Host SSRF via host header",
      "category": "host_header",
      "subcategory": "ssrf",
      "payload": "X-Host: 127.0.0.1:8080",
      "encoded": "X-Host%3A%20127.0.0.1%3A8080",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_MULTI_001",
      "name": "CRLF double Host injection",
      "category": "host_header",
      "subcategory": "multi_host",
      "payload": "Host: good.com\\r\\nHost: evil.com",
      "encoded": "Host%3A%20good.com%0d%0aHost%3A%20evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_CHAIN_001",
      "name": "X-Forwarded-Host chain injection",
      "category": "host_header",
      "subcategory": "chain_injection",
      "payload": "x-forwarded-host:evil.com\\r\\nx-forwarded-host:evil2.com",
      "encoded": "x-forwarded-host%3Aevil.com%0d%0ax-forwarded-host%3Aevil2.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_PORT_001",
      "name": "Port injection via Host",
      "category": "host_header",
      "subcategory": "port_injection",
      "payload": "x-host:good.com:8443@evil.com",
      "encoded": "x-host%3Agood.com%3A8443%40evil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_ABS_001",
      "name": "Absolute URL Host override",
      "category": "host_header",
      "subcategory": "absolute_url",
      "payload": "x-original-host:https://evil.com",
      "encoded": "x-original-host%3Ahttps%3A%2F%2Fevil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_XHOST_001",
      "name": "X-Host with internal IP",
      "category": "host_header",
      "subcategory": "internal_ip",
      "payload": "x-host:10.0.0.1",
      "encoded": "x-host%3A10.0.0.1",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "HHI_FWD_PORT_001",
      "name": "X-Forwarded-Host with port",
      "category": "host_header",
      "subcategory": "forwarded_port",
      "payload": "x-forwarded-host:evil.com:443",
      "encoded": "x-forwarded-host%3Aevil.com%3A443",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Host Header] Host header injection attempt detected"
    },
    {
      "id": "FP_HHI_001",
      "name": "Normal X-Forwarded-For header",
      "category": "host_header",
      "subcategory": "false_positive",
      "payload": "x-forwarded-for:192.168.1.1",
      "encoded": "x-forwarded-for%3A192.168.1.1",
      "port": 80,
      "expected_detection": false,
      "severity": "info",
      "expected_rule": "NONE"
    }
  ]
}