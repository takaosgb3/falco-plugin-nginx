{
  "metadata": {
    "category": "pickle",
    "total_patterns": 15,
    "port": 8001,
    "description": "k6 test patterns for Pickle Deserialization attacks"
  },
  "patterns": [
    {
      "id": "PICKLE_DESER_001",
      "name": "Basic __reduce__ Method Exploit",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "__reduce__",
      "encoded": "__reduce__",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Deserialization attack"
    },
    {
      "id": "PICKLE_DESER_002",
      "name": "pickle.loads Remote Code Execution",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "pickle.loads(base64.b64decode(data))",
      "encoded": "pickle.loads%28base64.b64decode%28data%29%29",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Deserialization attack"
    },
    {
      "id": "PICKLE_DESER_003",
      "name": "cPickle.loads Remote Code Execution",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "cPickle.loads(data)",
      "encoded": "cPickle.loads%28data%29",
      "port": 8001,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Deserialization attack"
    },
    {
      "id": "PICKLE_DESER_004",
      "name": "Class MRO Traversal Attack",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "__class__.__mro__[1].__subclasses__()",
      "encoded": "%5F%5Fclass%5F%5F.%5F%5Fmro%5F%5F%5B1%5D.%5F%5Fsubclasses%5F%5F%28%29",
      "port": 8001,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Pickle Attack] Pickle deserialization attack attempt"
    },
    {
      "id": "PICKLE_DESER_005",
      "name": "__reduce__ Method with Module Context",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "module.__reduce__",
      "encoded": "module.__reduce__",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Deserialization attack",
      "description": "Pickle __reduce__ exploitation via module attribute access"
    },
    {
      "id": "PICKLE_DESER_006",
      "name": "pickle.loads with Request Data",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "pickle.loads(request.data)",
      "encoded": "pickle.loads%28request.data%29",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Deserialization attack",
      "description": "Pickle deserialization of untrusted request data"
    },
    {
      "id": "PICKLE_DESER_007",
      "name": "URL-encoded __reduce__ Exploit",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "__reduce__",
      "encoded": "%5F%5Freduce%5F%5F",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Pickle Attack] Pickle deserialization attack attempt",
      "description": "URL-encoded __reduce__ bypasses general deserialization rule, caught by Pickle-specific rule"
    },
    {
      "id": "PICKLE_DESER_008",
      "name": "Class MRO Index 2 Traversal",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "__class__.__mro__[2].__subclasses__()",
      "encoded": "__class__.__mro__%5B2%5D.__subclasses__%28%29",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Pickle Attack] Pickle deserialization attack attempt",
      "description": "MRO traversal at index 2 for deeper class hierarchy access"
    },
    {
      "id": "PICKLE_DESER_009",
      "name": "cPickle.loads with Serialized Payload",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "cPickle.loads(serialized)",
      "encoded": "cPickle.loads%28serialized%29",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Deserialization attack",
      "description": "cPickle deserialization of serialized payload data"
    },
    {
      "id": "PICKLE_DESER_010",
      "name": "URL-encoded Class MRO Index 0 Traversal",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "__class__.__mro__[0]",
      "encoded": "%5F%5Fclass%5F%5F.%5F%5Fmro%5F%5F%5B0%5D",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Pickle Attack] Pickle deserialization attack attempt",
      "description": "URL-encoded MRO traversal at index 0 for base class access"
    },
    {
      "id": "PICKLE_DESER_011",
      "name": "Uppercase __REDUCE__ Case Bypass",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "__REDUCE__",
      "encoded": "__REDUCE__",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Pickle Attack] Pickle deserialization attack attempt",
      "description": "Uppercase __REDUCE__ bypasses Deserialization rule (case-sensitive contains) but caught by Pickle rule (icontains)"
    },
    {
      "id": "PICKLE_DESER_012",
      "name": "URL-encoded MRO Index 3 Traversal",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "__class__.__mro__[3]",
      "encoded": "%5F%5Fclass%5F%5F.%5F%5Fmro%5F%5F%5B3%5D",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Pickle Attack] Pickle deserialization attack attempt",
      "description": "URL-encoded MRO traversal at index 3 to test %5F%5Fclass%5F%5F.%5F%5Fmro%5F%5F condition"
    },
    {
      "id": "PICKLE_DESER_013",
      "name": "MRO __getitem__ Method Access",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "__class__.__mro__.__getitem__(0)",
      "encoded": "__class__.__mro__.__getitem__%280%29",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Pickle Attack] Pickle deserialization attack attempt",
      "description": "Alternative MRO access via __getitem__ method to test __class__.__mro__ condition"
    },
    {
      "id": "PICKLE_DESER_014",
      "name": "YAML Unsafe Load Deserialization",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "yaml.load(data)",
      "encoded": "yaml.load%28data%29",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Deserialization attack",
      "description": "YAML unsafe load deserialization to test yaml.load condition in Deserialization rule"
    },
    {
      "id": "PICKLE_DESER_015",
      "name": "Python YAML Object Instantiation",
      "category": "pickle",
      "subcategory": "deserialization",
      "payload": "!!python/object:os.system",
      "encoded": "!!python/object:os.system",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Deserialization attack",
      "description": "Python YAML !!python tag for arbitrary object instantiation to test !!python condition"
    }
  ]
}
