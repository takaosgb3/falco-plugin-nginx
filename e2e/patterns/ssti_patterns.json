{
  "metadata": {
    "category": "ssti",
    "total_patterns": 15,
    "port": 80,
    "description": "k6 test patterns for Server-Side Template Injection attacks",
    "phase": "Phase 9 Stage 1",
    "updated": "2026-02-12"
  },
  "patterns": [
    {
      "id": "SSTI_JINJA_001",
      "name": "Jinja2 basic template injection test",
      "category": "ssti",
      "subcategory": "jinja2",
      "payload": "{{7*7}}",
      "encoded": "%7B%7B7%2A7%7D%7D",
      "port": 8010,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "Template injection"
    },
    {
      "id": "SSTI_JINJA_002",
      "name": "Jinja2 config disclosure injection",
      "category": "ssti",
      "subcategory": "jinja2",
      "payload": "{{config.items()}}",
      "encoded": "%7B%7Bconfig.items%28%29%7D%7D",
      "port": 8010,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Template injection"
    },
    {
      "id": "SSTI_JINJA_003",
      "name": "Jinja2 Lipsum Function Injection",
      "category": "ssti",
      "subcategory": "jinja2",
      "payload": "{{lipsum(1)}}",
      "encoded": "%7B%7Blipsum(1)%7D%7D",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Emerging Threat] Template injection",
      "description": "Phase 9: Jinja2 lipsum built-in function exploitation"
    },
    {
      "id": "SSTI_VEL_001",
      "name": "Velocity template runtime execution",
      "category": "ssti",
      "subcategory": "velocity",
      "payload": "#set($runtime = $runtime.getRuntime())$runtime.exec('whoami')",
      "encoded": "%23set%28%24runtime%20%3D%20%24runtime.getRuntime%28%29%29%24runtime.exec%28%27whoami%27%29",
      "port": 8010,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Spring4Shell attack"
    },
    {
      "id": "SSTI_VEL_002",
      "name": "Velocity class inspection RCE",
      "category": "ssti",
      "subcategory": "velocity",
      "payload": "$class.inspect(\"java.lang.Runtime\").type.getRuntime().exec(\"id\")",
      "encoded": "%24class.inspect%28%22java.lang.Runtime%22%29.type.getRuntime%28%29.exec%28%22id%22%29",
      "port": 8010,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Spring4Shell attack"
    },
    {
      "id": "SSTI_FREEMKR_001",
      "name": "FreeMarker template command execution",
      "category": "ssti",
      "subcategory": "freemarker",
      "payload": "<#assign ex=\"freemarker.template.utility.Execute\"?new()> ${ex(\"whoami\")}",
      "encoded": "%3C%23assign%20ex%3D%22freemarker.template.utility.Execute%22%3Fnew%28%29%3E%20%24%7Bex%28%22whoami%22%29%7D",
      "port": 8010,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "Template injection"
    },
    {
      "id": "SSTI_THYME_001",
      "name": "Thymeleaf expression injection",
      "category": "ssti",
      "subcategory": "thymeleaf",
      "payload": "__${T(java.lang.Runtime).getRuntime().exec(\"id\")}__",
      "encoded": "__%24%7BT(java.lang.Runtime).getRuntime().exec(%22id%22)%7D__",
      "port": 8005,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Spring4Shell attack"
    },
    {
      "id": "SSTI_PEBBLE_001",
      "name": "Pebble command execution",
      "category": "ssti",
      "subcategory": "pebble",
      "payload": "{% set cmd = \"id\" %}{{ system(cmd) }}",
      "encoded": "%7B%25%20set%20cmd%20%3D%20%22id%22%20%25%7D%7B%7B%20system(cmd)%20%7D%7D",
      "port": 8005,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Template injection"
    },
    {
      "id": "SSTI_SMARTY_001",
      "name": "Smarty PHP code execution",
      "category": "ssti",
      "subcategory": "smarty",
      "payload": "{php}system(\"id\");{/php}",
      "encoded": "%7Bphp%7Dsystem(%22id%22)%3B%7B%2Fphp%7D",
      "port": 8005,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSTI] Server-Side Template Injection detected"
    },
    {
      "id": "SSTI_TWIG_001",
      "name": "Twig file read",
      "category": "ssti",
      "subcategory": "twig",
      "payload": "{{\"/etc/passwd\"|file_excerpt(1,30)}}",
      "encoded": "%7B%7B%22%2Fetc%2Fpasswd%22%7Cfile_excerpt(1%2C30)%7D%7D",
      "port": 8005,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Traversal] File inclusion attack detected"
    },
    {
      "id": "SSTI_MAKO_001",
      "name": "Mako Python execution",
      "category": "ssti",
      "subcategory": "mako",
      "payload": "${self.module.cache.util.os.system(\"id\")}",
      "encoded": "%24%7Bself.module.cache.util.os.system(%22id%22)%7D",
      "port": 8005,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Template injection"
    },
    {
      "id": "SSTI_NUNJUCKS_001",
      "name": "Nunjucks Range Function Injection",
      "category": "ssti",
      "subcategory": "nunjucks",
      "payload": "{{range(10)}}",
      "encoded": "%7B%7Brange(10)%7D%7D",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Emerging Threat] Template injection",
      "description": "Phase 9: Nunjucks/Jinja2 range function for data enumeration"
    },
    {
      "id": "SSTI_EL_001",
      "name": "Expression Language Injection",
      "category": "ssti",
      "subcategory": "expression_language",
      "payload": "${7*7}",
      "encoded": "%24%7B7*7%7D",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Emerging Threat] Template injection",
      "description": "Phase 9: Java/JSP Expression Language injection"
    },
    {
      "id": "SSTI_EJS_001",
      "name": "EJS Template Output Injection",
      "category": "ssti",
      "subcategory": "ejs",
      "payload": "<%=7*7%>",
      "encoded": "%3C%25%3D7*7%25%3E",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Emerging Threat] Template injection",
      "description": "Phase 9: EJS/ERB template output tag injection"
    },
    {
      "id": "SSTI_DJANGO_001",
      "name": "Django Debug Template Tag",
      "category": "ssti",
      "subcategory": "django",
      "payload": "{% debug %}",
      "encoded": "%7B%25%20debug%20%25%7D",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX SSTI] Server-Side Template Injection detected",
      "description": "Phase 9: Django template debug tag for information disclosure"
    }
  ]
}
