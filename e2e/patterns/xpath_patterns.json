{
  "metadata": {
    "category": "xpath",
    "total_patterns": 25,
    "port": 8009,
    "description": "k6 test patterns for XPath injection attacks"
  },
  "patterns": [
    {
      "id": "XPATH_BOOL_001",
      "name": "XPath boolean injection",
      "category": "xpath",
      "subcategory": "boolean_based",
      "payload": "' or '1'='1",
      "encoded": "%27%20or%20%271%27%3D%271",
      "port": 8009,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "XPath injection attempt"
    },
    {
      "id": "XPATH_PAREN_001",
      "name": "XPath parenthesis bypass injection",
      "category": "xpath",
      "subcategory": "authentication_bypass",
      "payload": "') or ('1'='1",
      "encoded": "%27%29%20or%20%28%271%27%3D%271",
      "port": 8009,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "XPath injection attempt"
    },
    {
      "id": "XPATH_FUNC_001",
      "name": "XPath count function injection",
      "category": "xpath",
      "subcategory": "function_abuse",
      "payload": "' and count(//user)>0 and '1'='1",
      "encoded": "%27%20and%20count%28%2F%2Fuser%29%3E0%20and%20%271%27%3D%271",
      "port": 8009,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "XPath injection attempt"
    },
    {
      "id": "XPATH_BLIND_001",
      "name": "XPath substring blind injection",
      "category": "xpath",
      "subcategory": "blind",
      "payload": "' or substring(//user[1]/password,1,1)='a' or '1'='2",
      "encoded": "%27%20or%20substring%28%2F%2Fuser%5B1%5D%2Fpassword%2C1%2C1%29%3D%27a%27%20or%20%271%27%3D%272",
      "port": 8009,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "XPath injection attempt"
    },
    {
      "id": "XPATH_ENUM_001",
      "name": "XPath string-length enumeration",
      "category": "xpath",
      "subcategory": "enumeration",
      "payload": "' or string-length(//user[1]/password)>5 or '1'='2",
      "encoded": "%27%20or%20string-length%28%2F%2Fuser%5B1%5D%2Fpassword%29%3E5%20or%20%271%27%3D%272",
      "port": 8009,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "XPath injection attempt"
    },
    {
      "id": "XPATH_AND_001",
      "name": "XPath AND-based injection with count function",
      "category": "xpath",
      "subcategory": "function_abuse",
      "payload": "' and count(//*) > 0",
      "encoded": "%27%20and%20count%28%2F%2F*%29%3E0",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath AND injection with wildcard count function"
    },
    {
      "id": "XPATH_BOOL_002",
      "name": "XPath OR-based boolean with true() function",
      "category": "xpath",
      "subcategory": "boolean_based",
      "payload": "' or true() or '",
      "encoded": "%27%20or%20true%28%29%20or%20%27",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath boolean injection using true() function"
    },
    {
      "id": "XPATH_FUNC_002",
      "name": "XPath substring function name extraction",
      "category": "xpath",
      "subcategory": "blind",
      "payload": "' or substring(//user[1]/name,1,1)='a",
      "encoded": "%27%20or%20substring%28%2F%2Fuser%5B1%5D%2Fname%2C1%2C1%29%3D%27a",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath substring extraction targeting user name field"
    },
    {
      "id": "XPATH_BLIND_002",
      "name": "XPath string-length blind name enumeration",
      "category": "xpath",
      "subcategory": "enumeration",
      "payload": "' and string-length(//user[1]/name)>3 and '1'='1",
      "encoded": "%27%20and%20string-length%28%2F%2Fuser%5B1%5D%2Fname%29%3E3%20and%20%271%27%3D%271",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath blind injection using string-length on name field"
    },
    {
      "id": "XPATH_PAREN_002",
      "name": "XPath parenthesis bypass with true() function",
      "category": "xpath",
      "subcategory": "authentication_bypass",
      "payload": "') or true() or ('",
      "encoded": "%27%29%20or%20true%28%29%20or%20%28%27",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath parenthesis bypass using true() for authentication bypass"
    },
    {
      "id": "XPATH_FUNC_003",
      "name": "XPath standalone count function probe",
      "category": "xpath",
      "subcategory": "function_abuse",
      "payload": "count(//node)>0",
      "encoded": "count%28%2F%2Fnode%29%3E0",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "Standalone count() function without quote prefix to independently test count%28%2F%2F condition"
    },
    {
      "id": "XPATH_FUNC_004",
      "name": "XPath standalone substring function probe",
      "category": "xpath",
      "subcategory": "blind",
      "payload": "substring(//user,1,1)",
      "encoded": "substring%28%2F%2Fuser%2C1%2C1%29",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "Standalone substring() function without quote prefix to independently test substring%28%2F%2F condition"
    },
    {
      "id": "XPATH_ENUM_002",
      "name": "XPath standalone string-length function probe",
      "category": "xpath",
      "subcategory": "enumeration",
      "payload": "string-length(//password)>0",
      "encoded": "string-length%28%2F%2Fpassword%29%3E0",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "Standalone string-length() function without quote prefix to independently test string-length%28%2F%2F condition"
    },
    {
      "id": "XPATH_BOOL_003",
      "name": "XPath AND injection with normalize-space function",
      "category": "xpath",
      "subcategory": "boolean_based",
      "payload": "' and normalize-space(//secret)!=''",
      "encoded": "%27%20and%20normalize-space%28%2F%2Fsecret%29%21%3D%27%27",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath AND injection with normalize-space() to test %27%20and%20 condition with different function context"
    },
    {
      "id": "XPATH_PAREN_003",
      "name": "XPath parenthesis bypass with count function",
      "category": "xpath",
      "subcategory": "authentication_bypass",
      "payload": "') or count(//admin)>0 or ('",
      "encoded": "%27%29%20or%20count%28%2F%2Fadmin%29%3E0%20or%20%28%27",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath parenthesis bypass combined with count() to test %27%29%20or%20 and count%28%2F%2F conditions together"
    },
    {
      "id": "XPATH_FUNC_005",
      "name": "XPath concat function injection",
      "category": "xpath",
      "subcategory": "function_abuse",
      "payload": "concat(//user[1]/name,'_',//user[1]/role)",
      "encoded": "concat%28%2F%2Fuser%5B1%5D%2Fname%2C%27_%27%2C%2F%2Fuser%5B1%5D%2Frole%29",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath concat() function to test concat%28%2F%2F condition. Needs Error SQLi exception (concat)."
    },
    {
      "id": "XPATH_FUNC_006",
      "name": "XPath translate function injection",
      "category": "xpath",
      "subcategory": "function_abuse",
      "payload": "translate(//user[1]/name,'abc','ABC')",
      "encoded": "translate%28%2F%2Fuser%5B1%5D%2Fname%2C%27abc%27%2C%27ABC%27%29",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath translate() function to test translate%28%2F%2F condition"
    },
    {
      "id": "XPATH_FUNC_007",
      "name": "XPath contains function injection",
      "category": "xpath",
      "subcategory": "function_abuse",
      "payload": "contains(//user[1]/name,'admin')",
      "encoded": "contains%28%2F%2Fuser%5B1%5D%2Fname%2C%27admin%27%29",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath contains() function to test contains%28%2F%2F condition"
    },
    {
      "id": "XPATH_BLIND_003",
      "name": "XPath substring blind role extraction",
      "category": "xpath",
      "subcategory": "blind",
      "payload": "' or substring(//user[1]/role,1,1)='a' or '1'='2",
      "encoded": "%27%20or%20substring%28%2F%2Fuser%5B1%5D%2Frole%2C1%2C1%29%3D%27a%27%20or%20%271%27%3D%272",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath substring blind injection targeting role field. Needs Boolean SQLi exception (substring)."
    },
    {
      "id": "XPATH_BLIND_004",
      "name": "XPath string-length blind role enumeration",
      "category": "xpath",
      "subcategory": "blind",
      "payload": "' or string-length(//user[1]/role)>3 and '1'='1",
      "encoded": "%27%20or%20string-length%28%2F%2Fuser%5B1%5D%2Frole%29%3E3%20and%20%271%27%3D%271",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath string-length blind injection on role field"
    },
    {
      "id": "XPATH_ENUM_003",
      "name": "XPath position function enumeration",
      "category": "xpath",
      "subcategory": "enumeration",
      "payload": "position()=1",
      "encoded": "position%28%29%3D1",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath position() function to test position%28%29 condition"
    },
    {
      "id": "XPATH_ENUM_004",
      "name": "XPath last function enumeration",
      "category": "xpath",
      "subcategory": "enumeration",
      "payload": "last()",
      "encoded": "last%28%29",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath last() function to test last%28%29 condition"
    },
    {
      "id": "XPATH_BOOL_004",
      "name": "XPath not function boolean injection",
      "category": "xpath",
      "subcategory": "boolean_based",
      "payload": "' or not(false()) or '",
      "encoded": "%27%20or%20not%28false%28%29%29%20or%20%27",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath not(false()) boolean injection to test not%28false condition"
    },
    {
      "id": "XPATH_PAREN_004",
      "name": "XPath parenthesis bypass with position function",
      "category": "xpath",
      "subcategory": "authentication_bypass",
      "payload": "') or position()=1 or ('",
      "encoded": "%27%29%20or%20position%28%29%3D1%20or%20%28%27",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath parenthesis bypass with position() to test existing %27%29%20or%20 condition"
    },
    {
      "id": "XPATH_COMMENT_001",
      "name": "XPath comment injection",
      "category": "xpath",
      "subcategory": "comment",
      "payload": "' or 1=1 (: XPath comment :)",
      "encoded": "%27%20or%201%3D1%20%28%3A%20XPath%20comment%20%3A%29",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX XPath Injection] XPath injection attempt",
      "description": "XPath comment syntax (: :) to test %28%3A condition for false positive analysis"
    }
  ]
}
