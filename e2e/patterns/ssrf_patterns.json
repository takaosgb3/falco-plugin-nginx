{
  "metadata": {
    "category": "ssrf",
    "description": "Server-Side Request Forgery (SSRF) attack patterns",
    "total_patterns": 15,
    "phase": "Phase 9 Stage 1",
    "created": "2026-02-11",
    "updated": "2026-02-12"
  },
  "patterns": [
    {
      "id": "SSRF_CLOUD_001",
      "name": "AWS IMDSv1 Metadata Access",
      "category": "ssrf",
      "subcategory": "cloud_metadata",
      "payload": "http://169.254.169.254/latest/meta-data/",
      "encoded": "http%3A%2F%2F169.254.169.254%2Flatest%2Fmeta-data%2F",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_CLOUD_002",
      "name": "GCP Metadata Service Access",
      "category": "ssrf",
      "subcategory": "cloud_metadata",
      "payload": "http://metadata.google.internal/computeMetadata/v1/",
      "encoded": "http%3A%2F%2Fmetadata.google.internal%2FcomputeMetadata%2Fv1%2F",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_CLOUD_003",
      "name": "Azure Instance Metadata Access",
      "category": "ssrf",
      "subcategory": "cloud_metadata",
      "payload": "http://169.254.169.254/metadata/instance",
      "encoded": "http%3A%2F%2F169.254.169.254%2Fmetadata%2Finstance",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_CLOUD_004",
      "name": "AWS IMDSv2 Token Endpoint Access",
      "category": "ssrf",
      "subcategory": "cloud_metadata",
      "payload": "http://169.254.169.254/latest/api/token",
      "encoded": "http%3A%2F%2F169.254.169.254%2Flatest%2Fapi%2Ftoken",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected",
      "description": "Phase 9: AWS IMDSv2 token endpoint for credential theft"
    },
    {
      "id": "SSRF_CLOUD_005",
      "name": "AWS IAM Security Credentials Access",
      "category": "ssrf",
      "subcategory": "cloud_metadata",
      "payload": "http://169.254.169.254/latest/meta-data/iam/security-credentials/",
      "encoded": "http%3A%2F%2F169.254.169.254%2Flatest%2Fmeta-data%2Fiam%2Fsecurity-credentials%2F",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected",
      "description": "Phase 9: AWS IAM role credential extraction"
    },
    {
      "id": "SSRF_INT_001",
      "name": "Internal Redis Service Access",
      "category": "ssrf",
      "subcategory": "internal_service",
      "payload": "http://localhost:6379/",
      "encoded": "http%3A%2F%2Flocalhost%3A6379%2F",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_INT_002",
      "name": "Internal Elasticsearch Access",
      "category": "ssrf",
      "subcategory": "internal_service",
      "payload": "http://127.0.0.1:9200/_cat/indices",
      "encoded": "http%3A%2F%2F127.0.0.1%3A9200%2F_cat%2Findices",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_INT_003",
      "name": "Internal Consul Service Access",
      "category": "ssrf",
      "subcategory": "internal_service",
      "payload": "http://0.0.0.0:8500/v1/agent/members",
      "encoded": "http%3A%2F%2F0.0.0.0%3A8500%2Fv1%2Fagent%2Fmembers",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_INT_004",
      "name": "Kubernetes API via Lowercase Encoded Localhost",
      "category": "ssrf",
      "subcategory": "internal_service",
      "payload": "http://localhost:8443/api/v1/pods",
      "encoded": "http%3a%2f%2flocalhost%3a8443%2fapi%2fv1%2fpods",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected",
      "description": "Phase 9: Tests lowercase http%3a%2f%2flocalhost condition"
    },
    {
      "id": "SSRF_INT_005",
      "name": "Docker API via Lowercase Encoded 0.0.0.0",
      "category": "ssrf",
      "subcategory": "internal_service",
      "payload": "http://0.0.0.0:2375/containers/json",
      "encoded": "http%3a%2f%2f0.0.0.0%3a2375%2fcontainers%2fjson",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected",
      "description": "Phase 9: Tests lowercase http%3a%2f%2f0.0.0.0 condition"
    },
    {
      "id": "SSRF_DNS_001",
      "name": "Hex IP Bypass for Localhost",
      "category": "ssrf",
      "subcategory": "dns_rebinding",
      "payload": "http://0x7f000001/",
      "encoded": "http%3A%2F%2F0x7f000001%2F",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_DNS_002",
      "name": "Decimal IP Bypass for Localhost",
      "category": "ssrf",
      "subcategory": "dns_rebinding",
      "payload": "http://2130706433/",
      "encoded": "http%3A%2F%2F2130706433%2F",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_SCHEME_001",
      "name": "File Scheme Local File Read",
      "category": "ssrf",
      "subcategory": "protocol_smuggling",
      "payload": "file:///etc/passwd",
      "encoded": "file%3A%2F%2F%2Fetc%2Fpasswd",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_SCHEME_002",
      "name": "Gopher Protocol Smuggling",
      "category": "ssrf",
      "subcategory": "protocol_smuggling",
      "payload": "gopher://127.0.0.1:25/",
      "encoded": "gopher%3A%2F%2F127.0.0.1%3A25%2F",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected"
    },
    {
      "id": "SSRF_SCHEME_003",
      "name": "Dict Protocol Memcached Access",
      "category": "ssrf",
      "subcategory": "protocol_smuggling",
      "payload": "dict://attacker.com:11211/stat",
      "encoded": "dict%3A%2F%2Fattacker.com%3A11211%2Fstat",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX SSRF] SSRF attack attempt detected",
      "description": "Phase 9: Tests dict:// protocol condition (previously uncovered)"
    }
  ]
}
