{
  "metadata": {
    "category": "graphql",
    "total_patterns": 15,
    "port": 8008,
    "description": "k6 test patterns for GraphQL injection"
  },
  "patterns": [
    {
      "id": "GQL_INTRO_001",
      "name": "GraphQL introspection schema enumeration",
      "category": "graphql",
      "subcategory": "introspection",
      "payload": "query{__schema{types{name}}}",
      "encoded": "query%7B__schema%7Btypes%7Bname%7D%7D%7D",
      "port": 8008,
      "expected_detection": true,
      "expected_rule": "[NGINX Emerging Threat] Template injection",
      "severity": "medium"
    },
    {
      "id": "GQL_INTRO_002",
      "name": "GraphQL type field enumeration",
      "category": "graphql",
      "subcategory": "introspection",
      "payload": "query{__type(name:\"User\"){fields{name}}}",
      "encoded": "query%7B__type(name%3A%22User%22)%7Bfields%7Bname%7D%7D%7D",
      "port": 8008,
      "expected_detection": true,
      "expected_rule": "[NGINX SSTI] Server-Side Template Injection detected",
      "severity": "medium"
    },
    {
      "id": "GQL_INTRO_003",
      "name": "GraphQL mutation schema access",
      "category": "graphql",
      "subcategory": "introspection",
      "payload": "mutation{__schema{queryType{name}}}",
      "encoded": "mutation%7B__schema%7BqueryType%7Bname%7D%7D%7D",
      "port": 8008,
      "expected_detection": true,
      "expected_rule": "[NGINX Emerging Threat] Template injection",
      "severity": "medium"
    },
    {
      "id": "GQL_DATA_001",
      "name": "GraphQL mass data extraction",
      "category": "graphql",
      "subcategory": "data_extraction",
      "payload": "{users(first:999999){id,email,password}}",
      "encoded": "%7Busers(first%3A999999)%7Bid%2Cemail%2Cpassword%7D%7D",
      "port": 8008,
      "expected_detection": true,
      "expected_rule": "[NGINX Emerging Threat] Template injection",
      "severity": "high"
    },
    {
      "id": "GQL_SQLI_001",
      "name": "GraphQL SQL injection in argument",
      "category": "graphql",
      "subcategory": "sqli_injection",
      "payload": "query{user(id:\"1' UNION SELECT * FROM admin_users--\"){name}}",
      "encoded": "query%7Buser(id%3A%221'%20UNION%20SELECT%20*%20FROM%20admin_users--%22)%7Bname%7D%7D",
      "port": 8008,
      "expected_detection": true,
      "expected_rule": "[NGINX SQLi] Boolean-based Blind SQL Injection",
      "severity": "critical"
    },
    {
      "id": "GQL_INTRO_004",
      "name": "GraphQL __typename introspection query",
      "category": "graphql",
      "subcategory": "introspection",
      "payload": "__typename",
      "encoded": "__typename",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Introspection query detected",
      "severity": "medium",
      "description": "Simple __typename introspection without nested braces to target GraphQL rule directly"
    },
    {
      "id": "GQL_INTRO_005",
      "name": "GraphQL URL-encoded __schema introspection",
      "category": "graphql",
      "subcategory": "introspection",
      "payload": "__schema{queryType}",
      "encoded": "%5F%5Fschema%7BqueryType%7D",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Introspection query detected",
      "severity": "medium",
      "description": "URL-encoded __schema to match encoded introspection condition"
    },
    {
      "id": "GQL_INTRO_006",
      "name": "GraphQL URL-encoded __typename introspection",
      "category": "graphql",
      "subcategory": "introspection",
      "payload": "__typename",
      "encoded": "%5F%5Ftypename",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Introspection query detected",
      "severity": "medium",
      "description": "URL-encoded __typename to match encoded introspection condition"
    },
    {
      "id": "GQL_DATA_002",
      "name": "GraphQL mass extraction via limit keyword",
      "category": "graphql",
      "subcategory": "data_extraction",
      "payload": "limit:999999",
      "encoded": "limit%3A999999",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Mass data extraction attempt",
      "severity": "high",
      "description": "GraphQL limit parameter with large value for mass data extraction"
    },
    {
      "id": "GQL_DATA_003",
      "name": "GraphQL mass extraction via first keyword",
      "category": "graphql",
      "subcategory": "data_extraction",
      "payload": "first:999999",
      "encoded": "first%3A999999",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Mass data extraction attempt",
      "severity": "high",
      "description": "GraphQL first parameter with large value for mass data extraction"
    },
    {
      "id": "GQL_INTRO_007",
      "name": "GraphQL URL-encoded __type introspection",
      "category": "graphql",
      "subcategory": "introspection",
      "payload": "__type(name:\"Query\")",
      "encoded": "%5F%5Ftype(name%3A%22Query%22)",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Introspection query detected",
      "severity": "medium",
      "description": "URL-encoded __type to independently test %5F%5Ftype condition"
    },
    {
      "id": "GQL_INTRO_008",
      "name": "GraphQL raw __schema introspection",
      "category": "graphql",
      "subcategory": "introspection",
      "payload": "__schema",
      "encoded": "__schema",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Introspection query detected",
      "severity": "medium",
      "description": "Raw __schema keyword to test non-encoded introspection condition on port 80"
    },
    {
      "id": "GQL_DATA_004",
      "name": "GraphQL encoded users with password extraction",
      "category": "graphql",
      "subcategory": "data_extraction",
      "payload": "{users(first:10){id,password}}",
      "encoded": "%7Busers(first%3A10)%7Bid%2Cpassword%7D",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Mass data extraction attempt",
      "severity": "high",
      "description": "Tests %7Busers + password condition for mass data extraction"
    },
    {
      "id": "GQL_DATA_005",
      "name": "GraphQL raw first keyword mass extraction",
      "category": "graphql",
      "subcategory": "data_extraction",
      "payload": "first:9999",
      "encoded": "first:9999",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Mass data extraction attempt",
      "severity": "high",
      "description": "Raw first: with colon to test icontains 'first:' condition path (not first%3A)"
    },
    {
      "id": "GQL_DATA_006",
      "name": "GraphQL raw limit keyword mass extraction",
      "category": "graphql",
      "subcategory": "data_extraction",
      "payload": "limit:9999",
      "encoded": "limit:9999",
      "port": 80,
      "expected_detection": true,
      "expected_rule": "[NGINX GraphQL Attack] Mass data extraction attempt",
      "severity": "high",
      "description": "Raw limit: with colon to test icontains 'limit:' condition path (not limit%3A)"
    }
  ]
}
