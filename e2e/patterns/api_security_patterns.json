{
  "metadata": {
    "category": "api_security",
    "total_patterns": 27,
    "port": 8012,
    "description": "k6 test patterns for API security vulnerabilities (BOLA, JWT, Mass Assignment, GraphQL)",
    "phase": "Phase 11"
  },
  "patterns": [
    {
      "id": "API_BOLA_001",
      "name": "BOLA - Broken Object Level Authorization",
      "category": "api_security",
      "subcategory": "bola",
      "payload": "/api/v1/users/1/profile",
      "encoded": "%2Fapi%2Fv1%2Fusers%2F1%2Fprofile",
      "port": 8012,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "Attempts to access another user's profile by manipulating object ID"
    },
    {
      "id": "API_JWT_001",
      "name": "JWT Algorithm None Attack",
      "category": "api_security",
      "subcategory": "jwt",
      "payload": "eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6ImFkbWluIiwiaWF0IjoxNTE2MjM5MDIyfQ.",
      "encoded": "eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6ImFkbWluIiwiaWF0IjoxNTE2MjM5MDIyfQ.",
      "port": 8012,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "JWT with algorithm set to \"none\" to bypass signature verification"
    },
    {
      "id": "API_MASS_001",
      "name": "Mass Assignment - Role Escalation",
      "category": "api_security",
      "subcategory": "mass_assignment",
      "payload": "{\"username\":\"user\",\"role\":\"admin\",\"isAdmin\":true}",
      "encoded": "%7B%22username%22%3A%22user%22%2C%22role%22%3A%22admin%22%2C%22isAdmin%22%3Atrue%7D",
      "port": 8012,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "Attempts to set privileged fields through mass assignment"
    },
    {
      "id": "API_PROTO_001",
      "name": "Prototype Pollution Attack",
      "category": "api_security",
      "subcategory": "prototype_pollution",
      "payload": "{\"__proto__\":{\"isAdmin\":true}}",
      "encoded": "%7B%22__proto__%22%3A%7B%22isAdmin%22%3Atrue%7D%7D",
      "port": 8012,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "JavaScript prototype pollution to inject malicious properties"
    },
    {
      "id": "API_IDOR_001",
      "name": "IDOR - Insecure Direct Object Reference",
      "category": "api_security",
      "subcategory": "idor",
      "payload": "/api/v1/orders/99999/invoice",
      "encoded": "%2Fapi%2Fv1%2Forders%2F99999%2Finvoice",
      "port": 8012,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "Attempts to access invoices of other users by guessing order IDs"
    },
    {
      "id": "API_JWT_002",
      "name": "JWT Algorithm None with Admin Role Claim",
      "category": "api_security",
      "subcategory": "jwt",
      "payload": "eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJyb2xlIjoiYWRtaW4iLCJpc0FkbWluIjp0cnVlfQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "JWT with algorithm none and admin role claim",
      "encoded": "eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJyb2xlIjoiYWRtaW4iLCJpc0FkbWluIjp0cnVlfQ."
    },
    {
      "id": "API_JWT_003",
      "name": "JWT Algorithm None with User ID Claim",
      "category": "api_security",
      "subcategory": "jwt",
      "payload": "eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VyX2lkIjoiMSIsImFkbWluIjp0cnVlfQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "JWT none algorithm with user_id and admin claim",
      "encoded": "eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VyX2lkIjoiMSIsImFkbWluIjp0cnVlfQ."
    },
    {
      "id": "API_MASS_002",
      "name": "Mass Assignment isAdmin Privilege Escalation",
      "category": "api_security",
      "subcategory": "mass_assignment",
      "payload": "{\"isAdmin\":true,\"verified\":true}",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "Mass assignment setting isAdmin and verified flags",
      "encoded": "%7B%22isAdmin%22%3Atrue%2C%22verified%22%3Atrue%7D"
    },
    {
      "id": "API_MASS_003",
      "name": "Mass Assignment Role Admin Direct",
      "category": "api_security",
      "subcategory": "mass_assignment",
      "payload": "{\"email\":\"test@test.com\",\"role\":\"admin\"}",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "Mass assignment with email and admin role",
      "encoded": "%7B%22email%22%3A%22test%40test.com%22%2C%22role%22%3A%22admin%22%7D"
    },
    {
      "id": "API_MASS_004",
      "name": "Mass Assignment Multiple Admin Fields",
      "category": "api_security",
      "subcategory": "mass_assignment",
      "payload": "{\"permissions\":\"admin\",\"isAdmin\":true}",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "Mass assignment with permissions and isAdmin",
      "encoded": "%7B%22permissions%22%3A%22admin%22%2C%22isAdmin%22%3Atrue%7D"
    },
    {
      "id": "API_BOLA_002",
      "name": "BOLA User Profile v2 Enumeration",
      "category": "api_security",
      "subcategory": "bola",
      "payload": "/api/v2/users/2/profile",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "BOLA accessing another user profile via v2 API",
      "encoded": "%2Fapi%2Fv2%2Fusers%2F2%2Fprofile"
    },
    {
      "id": "API_BOLA_003",
      "name": "BOLA Admin User Profile Access",
      "category": "api_security",
      "subcategory": "bola",
      "payload": "/api/admin/users/100/profile",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "BOLA accessing admin user profile",
      "encoded": "%2Fapi%2Fadmin%2Fusers%2F100%2Fprofile"
    },
    {
      "id": "API_IDOR_002",
      "name": "IDOR Invoice v2 Enumeration",
      "category": "api_security",
      "subcategory": "idor",
      "payload": "/api/v2/orders/12345/invoice",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "IDOR accessing invoice via v2 API with guessed ID",
      "encoded": "%2Fapi%2Fv2%2Forders%2F12345%2Finvoice"
    },
    {
      "id": "API_PROTO_002",
      "name": "Prototype Pollution via Constructor",
      "category": "api_security",
      "subcategory": "prototype_pollution",
      "payload": "{\"constructor\":{\"prototype\":{\"isAdmin\":true}}}",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "Prototype pollution via constructor.prototype path",
      "encoded": "%7B%22constructor%22%3A%7B%22prototype%22%3A%7B%22isAdmin%22%3Atrue%7D%7D%7D"
    },
    {
      "id": "API_PROTO_003",
      "name": "Prototype Pollution Bracket Notation",
      "category": "api_security",
      "subcategory": "prototype_pollution",
      "payload": "__proto__[isAdmin]=true",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected",
      "description": "Prototype pollution via bracket notation",
      "encoded": "__proto__%5BisAdmin%5D%3Dtrue"
    },
    {
      "id": "AUTH_ADMIN_001",
      "name": "Admin path access attempt",
      "category": "api_security",
      "subcategory": "admin_access",
      "payload": "/admin/dashboard",
      "encoded": "%2Fadmin%2Fdashboard",
      "port": 80,
      "expected_detection": false,
      "severity": "medium",
      "expected_rule": "NONE"
    },
    {
      "id": "AUTH_ADMIN_002",
      "name": "Admin API access attempt",
      "category": "api_security",
      "subcategory": "admin_access",
      "payload": "/admin/api/users",
      "encoded": "%2Fadmin%2Fapi%2Fusers",
      "port": 80,
      "expected_detection": false,
      "severity": "medium",
      "expected_rule": "NONE"
    },
    {
      "id": "AUTH_LOGIN_001",
      "name": "Login brute force path",
      "category": "api_security",
      "subcategory": "login_access",
      "payload": "/login?user=admin&pass=test",
      "encoded": "%2Flogin%3Fuser%3Dadmin%26pass%3Dtest",
      "port": 80,
      "expected_detection": false,
      "severity": "medium",
      "expected_rule": "NONE"
    },
    {
      "id": "AUTH_LOGIN_002",
      "name": "wp-login access attempt",
      "category": "api_security",
      "subcategory": "login_access",
      "payload": "/wp-login.php",
      "encoded": "%2Fwp-login.php",
      "port": 80,
      "expected_detection": false,
      "severity": "medium",
      "expected_rule": "NONE"
    },
    {
      "id": "AUTH_API_001",
      "name": "Protected API access",
      "category": "api_security",
      "subcategory": "api_access",
      "payload": "/api/v1/admin/settings",
      "encoded": "%2Fapi%2Fv1%2Fadmin%2Fsettings",
      "port": 80,
      "expected_detection": false,
      "severity": "medium",
      "expected_rule": "NONE"
    },
    {
      "id": "API_JWT_004",
      "name": "JWT Algorithm None - short form",
      "category": "api_security",
      "subcategory": "jwt",
      "payload": "eyJhbGciOiJub25lIn0",
      "encoded": "eyJhbGciOiJub25lIn0",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected"
    },
    {
      "id": "API_JWT_005",
      "name": "JWT role admin claim",
      "category": "api_security",
      "subcategory": "jwt",
      "payload": "eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoiYWRtaW4ifQ",
      "encoded": "eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoiYWRtaW4ifQ",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected"
    },
    {
      "id": "API_JWT_006",
      "name": "JWT expired token bypass",
      "category": "api_security",
      "subcategory": "jwt",
      "payload": "eyJhbGciOiJIUzI1NiJ9.eyJleHAiOjB9",
      "encoded": "eyJhbGciOiJIUzI1NiJ9.eyJleHAiOjB9",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected"
    },
    {
      "id": "API_OAUTH_001",
      "name": "OAuth redirect_uri manipulation",
      "category": "api_security",
      "subcategory": "oauth",
      "payload": "redirect_uri=http://evil.com/callback",
      "encoded": "redirect_uri%3Dhttp%3A%2F%2Fevil.com%2Fcallback",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected"
    },
    {
      "id": "API_OAUTH_002",
      "name": "OAuth state parameter tampering",
      "category": "api_security",
      "subcategory": "oauth",
      "payload": "state=&code=auth_code",
      "encoded": "state%3D%26code%3Dauth_code",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected"
    },
    {
      "id": "API_OAUTH_003",
      "name": "OAuth scope escalation",
      "category": "api_security",
      "subcategory": "oauth",
      "payload": "scope=admin:all",
      "encoded": "scope%3Dadmin%3Aall",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected"
    },
    {
      "id": "API_TOKEN_001",
      "name": "Access token with admin privilege",
      "category": "api_security",
      "subcategory": "token_abuse",
      "payload": "access_token=eyJhbGciOi&admin=true",
      "encoded": "access_token%3DeyJhbGciOi%26admin%3Dtrue",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX API Attack] API security vulnerability detected"
    }
  ]
}
