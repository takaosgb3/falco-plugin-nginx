{
  "metadata": {
    "category": "crlf",
    "description": "CRLF (Carriage Return Line Feed) Injection attack patterns",
    "total_patterns": 31,
    "phase": "Phase 10 Stage 1",
    "created": "2026-02-11",
    "updated": "2026-02-14"
  },
  "patterns": [
    {
      "id": "CRLF_HDR_001",
      "name": "Cookie Header Injection via CRLF",
      "category": "crlf",
      "subcategory": "header_injection",
      "payload": "\\r\\nSet-Cookie:hacked=true",
      "encoded": "%0d%0aSet-Cookie%3Ahacked%3Dtrue",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_HDR_002",
      "name": "Custom Header Injection via CRLF",
      "category": "crlf",
      "subcategory": "header_injection",
      "payload": "\\r\\nX-Injected:true",
      "encoded": "%0d%0aX-Injected%3Atrue",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_HDR_003",
      "name": "Redirect Injection via CRLF",
      "category": "crlf",
      "subcategory": "header_injection",
      "payload": "\\r\\nLocation:http://evil.com",
      "encoded": "%0d%0aLocation%3Ahttp%3A%2F%2Fevil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_HDR_004",
      "name": "CORS Header Injection via Uppercase CRLF",
      "category": "crlf",
      "subcategory": "header_injection",
      "payload": "\\r\\nAccess-Control-Allow-Origin:*",
      "encoded": "%0D%0AAccess-Control-Allow-Origin%3A*",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 9: Tests uppercase %0D%0A condition"
    },
    {
      "id": "CRLF_HDR_005",
      "name": "X-Forwarded-For Spoofing via CRLF",
      "category": "crlf",
      "subcategory": "header_injection",
      "payload": "\\r\\nX-Forwarded-For:10.0.0.1",
      "encoded": "%0d%0aX-Forwarded-For%3A10.0.0.1",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 9: X-Forwarded-For header spoofing via CRLF"
    },
    {
      "id": "CRLF_LOG_001",
      "name": "HTTP Status Spoofing via Log Injection",
      "category": "crlf",
      "subcategory": "log_injection",
      "payload": "\\r\\n200 OK",
      "encoded": "%0d%0a200%20OK",
      "port": 80,
      "expected_detection": true,
      "severity": "medium",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_LOG_002",
      "name": "Fake Log Entry Injection",
      "category": "crlf",
      "subcategory": "log_injection",
      "payload": "\\r\\nFake-Log-Entry",
      "encoded": "%0d%0aFake-Log-Entry",
      "port": 80,
      "expected_detection": true,
      "severity": "medium",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_LOG_003",
      "name": "Fake Admin Access Log via CRLF",
      "category": "crlf",
      "subcategory": "log_injection",
      "payload": "\\r\\n127.0.0.1 GET /admin 200",
      "encoded": "%0d%0a127.0.0.1%20GET%20%2Fadmin%20200",
      "port": 80,
      "expected_detection": true,
      "severity": "medium",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 9: Fake log entry injection with admin path"
    },
    {
      "id": "CRLF_RESP_001",
      "name": "HTTP Response Splitting with HTML Injection",
      "category": "crlf",
      "subcategory": "response_splitting",
      "payload": "\\r\\n\\r\\n<html>injected</html>",
      "encoded": "%0d%0a%0d%0a%3Chtml%3Einjected%3C%2Fhtml%3E",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_RESP_002",
      "name": "Content-Type Header Injection",
      "category": "crlf",
      "subcategory": "response_splitting",
      "payload": "\\r\\nContent-Type:text/html\\r\\n",
      "encoded": "%0d%0aContent-Type%3Atext%2Fhtml%0d%0a",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_RESP_003",
      "name": "HTTP 302 Response Splitting",
      "category": "crlf",
      "subcategory": "response_splitting",
      "payload": "\\r\\nHTTP/1.1 302 Found\\r\\nLocation:http://evil.com",
      "encoded": "%0d%0aHTTP%2F1.1%20302%20Found%0d%0aLocation%3Ahttp%3A%2F%2Fevil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 9: Full HTTP response splitting with redirect"
    },
    {
      "id": "CRLF_ENC_001",
      "name": "Unicode Encoded CRLF Injection",
      "category": "crlf",
      "subcategory": "encoded_crlf",
      "payload": "Unicode CRLF U+560A U+560D",
      "encoded": "%E5%98%8A%E5%98%8D",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_ENC_002",
      "name": "LF-Only Injection (lowercase)",
      "category": "crlf",
      "subcategory": "encoded_crlf",
      "payload": "LF-only line feed injection",
      "encoded": "%0aInjectedHeader%3Atrue",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 9: Tests %0a (LF-only lowercase) condition"
    },
    {
      "id": "CRLF_ENC_003",
      "name": "LF-Only Injection (uppercase)",
      "category": "crlf",
      "subcategory": "encoded_crlf",
      "payload": "LF-only uppercase line feed injection",
      "encoded": "%0AInjectedHeader%3Atrue",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 9: Tests %0A (LF-only uppercase) condition - no cross-rule triggers"
    },
    {
      "id": "CRLF_ENC_004",
      "name": "Lowercase Unicode CRLF with Header Injection",
      "category": "crlf",
      "subcategory": "encoded_crlf",
      "payload": "Lowercase Unicode CRLF U+560A U+560D",
      "encoded": "%e5%98%8a%e5%98%8dX-Injected%3Amalicious",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 9: Tests lowercase %e5%98%8a%e5%98%8d Unicode condition"
    },
    {
      "id": "CRLF_RESP_004",
      "name": "XSS via CRLF Response Splitting",
      "category": "crlf",
      "subcategory": "response_splitting",
      "payload": "\\r\\n\\r\\n<script>alert(1)</script>",
      "encoded": "%0d%0a%0d%0a%3Cscript%3Ealert%281%29%3C%2Fscript%3E",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: XSS payload via CRLF response splitting (needs DOM XSS exception)"
    },
    {
      "id": "CRLF_RESP_005",
      "name": "Transfer-Encoding Injection via CRLF",
      "category": "crlf",
      "subcategory": "response_splitting",
      "payload": "\\r\\nTransfer-Encoding:chunked\\r\\n",
      "encoded": "%0d%0aTransfer-Encoding%3Achunked%0d%0a",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: Transfer-Encoding header injection for HTTP smuggling"
    },
    {
      "id": "CRLF_HDR_006",
      "name": "X-XSS-Protection Disable via CRLF",
      "category": "crlf",
      "subcategory": "header_injection",
      "payload": "\\r\\nX-XSS-Protection:0",
      "encoded": "%0d%0aX-XSS-Protection%3A0",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: Disable browser XSS protection via header injection"
    },
    {
      "id": "CRLF_HDR_007",
      "name": "CSP Override via CRLF",
      "category": "crlf",
      "subcategory": "header_injection",
      "payload": "\\r\\nContent-Security-Policy:default-src *",
      "encoded": "%0d%0aContent-Security-Policy%3Adefault-src%20*",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: Override Content-Security-Policy to allow all sources"
    },
    {
      "id": "CRLF_CACHE_001",
      "name": "Cache Poisoning via X-Forwarded-Host CRLF",
      "category": "crlf",
      "subcategory": "cache_poisoning",
      "payload": "\\r\\nX-Forwarded-Host:evil.com",
      "encoded": "%0d%0aX-Forwarded-Host%3Aevil.com",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: Cache poisoning via X-Forwarded-Host header injection"
    },
    {
      "id": "CRLF_CACHE_002",
      "name": "Cache Poisoning via X-Original-URL CRLF",
      "category": "crlf",
      "subcategory": "cache_poisoning",
      "payload": "\\r\\nX-Original-URL:/admin",
      "encoded": "%0d%0aX-Original-URL%3A%2Fadmin",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: Cache poisoning via X-Original-URL override"
    },
    {
      "id": "CRLF_SESSION_001",
      "name": "Session Fixation via JSESSIONID CRLF",
      "category": "crlf",
      "subcategory": "session_fixation",
      "payload": "\\r\\nSet-Cookie:JSESSIONID=attacker_session",
      "encoded": "%0d%0aSet-Cookie%3AJSESSIONID%3Dattacker_session",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: Java session fixation via Set-Cookie injection"
    },
    {
      "id": "CRLF_SESSION_002",
      "name": "Session Fixation via PHPSESSID CRLF",
      "category": "crlf",
      "subcategory": "session_fixation",
      "payload": "\\r\\nSet-Cookie:PHPSESSID=evil_session;Path=/",
      "encoded": "%0d%0aSet-Cookie%3APHPSESSID%3Devil_session%3BPath%3D%2F",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: PHP session fixation via Set-Cookie injection"
    },
    {
      "id": "CRLF_ENC_005",
      "name": "Double URL-Encoded CRLF Injection",
      "category": "crlf",
      "subcategory": "encoded_crlf",
      "payload": "Double URL-encoded CRLF with header injection",
      "encoded": "%250d%250aInjected-Header%3Atrue",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: Double URL-encoded CRLF (requires rule condition addition for %250d%250a)"
    },
    {
      "id": "CRLF_ENC_006",
      "name": "Null Byte with CRLF Injection",
      "category": "crlf",
      "subcategory": "encoded_crlf",
      "payload": "Null byte followed by CRLF injection",
      "encoded": "%00%0d%0aX-Null-Injected%3Atrue",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected",
      "description": "Phase 10: Null byte + CRLF bypass technique"
    },
    {
      "id": "CRLF_UTF8_001",
      "name": "UTF-8 encoded CRLF injection",
      "category": "crlf",
      "subcategory": "utf8_crlf",
      "payload": "%E5%98%8A%E5%98%8Dinjected-header:evil",
      "encoded": "%E5%98%8A%E5%98%8Dinjected-header%3Aevil",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_DOUBLE_001",
      "name": "Double CRLF for body injection",
      "category": "crlf",
      "subcategory": "body_injection",
      "payload": "%0d%0a%0d%0a<html>injected",
      "encoded": "%0d%0a%0d%0a%3Chtml%3Einjected",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_TAB_001",
      "name": "Tab-based header injection",
      "category": "crlf",
      "subcategory": "tab_injection",
      "payload": "%09injected-header:evil",
      "encoded": "%09injected-header%3Aevil",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_UNICODE_001",
      "name": "Unicode line separator injection",
      "category": "crlf",
      "subcategory": "unicode_separator",
      "payload": "%E2%80%A8injected",
      "encoded": "%E2%80%A8injected",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "CRLF_MIXED_001",
      "name": "Mixed encoding CRLF",
      "category": "crlf",
      "subcategory": "mixed_encoding",
      "payload": "%250d%250a%250d%250ainjected",
      "encoded": "%250d%250a%250d%250ainjected",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX CRLF] CRLF Injection attempt detected"
    },
    {
      "id": "FP_CRLF_001",
      "name": "Normal URL with newline in parameter",
      "category": "crlf",
      "subcategory": "false_positive",
      "payload": "/search?q=hello%0aworld",
      "encoded": "%2Fsearch%3Fq%3Dhello%0aworld",
      "port": 80,
      "expected_detection": false,
      "severity": "info",
      "expected_rule": "NONE"
    }
  ]
}