{
  "metadata": {
    "category": "jwt",
    "total_patterns": 15,
    "port": 80,
    "description": "k6 test patterns for JWT Token attacks",
    "phase": "Phase 12",
    "created": "2026-02-28"
  },
  "patterns": [
    {
      "id": "JWT_NONE_001",
      "name": "JWT alg:none bypass (lowercase)",
      "category": "jwt",
      "subcategory": "alg_none",
      "payload": "eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJhZG1pbiI6dHJ1ZX0.",
      "encoded": "eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJhZG1pbiI6dHJ1ZX0.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_NONE_002",
      "name": "JWT alg:None bypass (capitalized)",
      "category": "jwt",
      "subcategory": "alg_none",
      "payload": "eyJhbGciOiJOb25lIn0.eyJzdWIiOiIxMjMifQ.",
      "encoded": "eyJhbGciOiJOb25lIn0.eyJzdWIiOiIxMjMifQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_NONE_003",
      "name": "JWT alg:NONE bypass (uppercase)",
      "category": "jwt",
      "subcategory": "alg_none",
      "payload": "eyJhbGciOiJOT05FIn0.eyJzdWIiOiIxMjMifQ.",
      "encoded": "eyJhbGciOiJOT05FIn0.eyJzdWIiOiIxMjMifQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_CONFUSION_001",
      "name": "JWT HS256 key confusion attack",
      "category": "jwt",
      "subcategory": "key_confusion",
      "payload": "eyJhbGciOiJIUzI1NiJ9.eyJhZG1pbiI6dHJ1ZX0.",
      "encoded": "eyJhbGciOiJIUzI1NiJ9.eyJhZG1pbiI6dHJ1ZX0.",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_CLAIM_001",
      "name": "JWT claim manipulation with alg:none",
      "category": "jwt",
      "subcategory": "claim_manipulation",
      "payload": "eyJhbGciOiJub25lIn0.eyJhZG1pbiI6dHJ1ZX0.",
      "encoded": "eyJhbGciOiJub25lIn0.eyJhZG1pbiI6dHJ1ZX0.",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_EXPIRED_001",
      "name": "JWT expired token reuse with alg:none",
      "category": "jwt",
      "subcategory": "token_reuse",
      "payload": "eyJhbGciOiJub25lIn0.eyJleHAiOjAsInN1YiI6IjEyMyJ9.",
      "encoded": "eyJhbGciOiJub25lIn0.eyJleHAiOjAsInN1YiI6IjEyMyJ9.",
      "port": 80,
      "expected_detection": true,
      "severity": "medium",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_JKU_001",
      "name": "JWT JKU injection attack",
      "category": "jwt",
      "subcategory": "jku_injection",
      "payload": "eyJqa3UiOiJodHRwczovL2V2aWwuY29tIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIxMjMifQ.",
      "encoded": "eyJqa3UiOiJodHRwczovL2V2aWwuY29tIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIxMjMifQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "FP_JWT_001",
      "name": "Normal RS256 JWT verification",
      "category": "jwt",
      "subcategory": "false_positive",
      "payload": "/verify?token=eyJhbGciOiJSUzI1NiJ9",
      "encoded": "%2Fverify%3Ftoken%3DeyJhbGciOiJSUzI1NiJ9",
      "port": 80,
      "expected_detection": false,
      "severity": "info",
      "expected_rule": "NONE"
    },
    {
      "id": "JWT_KID_001",
      "name": "JWT kid injection (SQL)",
      "category": "jwt",
      "subcategory": "kid_injection",
      "payload": "eyJraWQiOiIxIE9SIDEiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxMjMifQ.",
      "encoded": "eyJraWQiOiIxIE9SIDEiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxMjMifQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_KID_002",
      "name": "JWT kid injection (path traversal)",
      "category": "jwt",
      "subcategory": "kid_injection",
      "payload": "eyJraWQiOiIuLi8uLi9kZXYvbnVsbCIsImFsZyI6IkhTMjU2In0.eyJzdWIiOiIxMjMifQ.",
      "encoded": "eyJraWQiOiIuLi8uLi9kZXYvbnVsbCIsImFsZyI6IkhTMjU2In0.eyJzdWIiOiIxMjMifQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_X5U_001",
      "name": "JWT x5u header injection",
      "category": "jwt",
      "subcategory": "x5u_injection",
      "payload": "eyJ4NXUiOiJodHRwczovL2V2aWwuY29tIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIxMjMifQ.",
      "encoded": "eyJ4NXUiOiJodHRwczovL2V2aWwuY29tIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIxMjMifQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_JWE_001",
      "name": "JWT JWE algorithm confusion",
      "category": "jwt",
      "subcategory": "jwe_confusion",
      "payload": "eyJlbmMiOiJBMTI4R0NNIiwiYWxnIjoiZGlyIn0..iv.ciphertext.tag",
      "encoded": "eyJlbmMiOiJBMTI4R0NNIiwiYWxnIjoiZGlyIn0..iv.ciphertext.tag",
      "port": 80,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_REPLAY_001",
      "name": "JWT token replay with alg none",
      "category": "jwt",
      "subcategory": "token_replay",
      "payload": "eyJhbGciOiJub25lIn0.eyJleHAiOjk5OTk5OTk5OTksInN1YiI6IjEyMyJ9.",
      "encoded": "eyJhbGciOiJub25lIn0.eyJleHAiOjk5OTk5OTk5OTksInN1YiI6IjEyMyJ9.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "JWT_JWKS_001",
      "name": "JWKS endpoint spoofing",
      "category": "jwt",
      "subcategory": "jwks_spoofing",
      "payload": "eyJqa3UiOiJodHRwczovL2V2aWwuY29tLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIxMjMifQ.",
      "encoded": "eyJqa3UiOiJodHRwczovL2V2aWwuY29tLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIxMjMifQ.",
      "port": 80,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX JWT] JWT token attack attempt detected"
    },
    {
      "id": "FP_JWT_002",
      "name": "Normal HS256 API token",
      "category": "jwt",
      "subcategory": "false_positive",
      "payload": "/api/auth?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9",
      "encoded": "%2Fapi%2Fauth%3Ftoken%3DeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9",
      "port": 80,
      "expected_detection": false,
      "severity": "info",
      "expected_rule": "NONE"
    }
  ]
}