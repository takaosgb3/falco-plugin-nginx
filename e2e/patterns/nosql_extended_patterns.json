{
  "metadata": {
    "category": "nosql_extended",
    "total_patterns": 8,
    "port": 8011,
    "description": "k6 test patterns for extended NoSQL injection attacks (CouchDB)"
  },
  "patterns": [
    {
      "id": "NOSQL_COUCH_001",
      "name": "CouchDB all documents disclosure",
      "category": "nosql_extended",
      "subcategory": "couchdb",
      "payload": "_all_docs?include_docs=true",
      "encoded": "_all_docs%3Finclude_docs%3Dtrue",
      "port": 8011,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "MongoDB NoSQL injection"
    },
    {
      "id": "NOSQL_COUCH_002",
      "name": "CouchDB design document view access",
      "category": "nosql_extended",
      "subcategory": "couchdb",
      "payload": "_design/test/_view/all",
      "encoded": "_design%2Ftest%2F_view%2Fall",
      "port": 8011,
      "expected_detection": true,
      "severity": "medium",
      "expected_rule": "MongoDB NoSQL injection"
    },
    {
      "id": "NOSQL_MONGO_001",
      "name": "MongoDB $where JavaScript injection",
      "category": "nosql_extended",
      "subcategory": "mongodb",
      "payload": "{\"$where\": \"this.username == 'admin'\"}",
      "encoded": "%7B%22%24where%22%3A%20%22this.username%20%3D%3D%20'admin'%22%7D",
      "port": 8011,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "MongoDB NoSQL injection"
    },
    {
      "id": "NOSQL_MONGO_002",
      "name": "MongoDB $regex bypass",
      "category": "nosql_extended",
      "subcategory": "mongodb",
      "payload": "{\"username\": {\"$regex\": \"^admin\"}}",
      "encoded": "%7B%22username%22%3A%20%7B%22%24regex%22%3A%20%22%5Eadmin%22%7D%7D",
      "port": 8011,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "MongoDB NoSQL injection"
    },
    {
      "id": "NOSQL_MONGO_003",
      "name": "MongoDB $gt operator bypass",
      "category": "nosql_extended",
      "subcategory": "mongodb",
      "payload": "{\"password\": {\"$gt\": \"\"}}",
      "encoded": "%7B%22password%22%3A%20%7B%22%24gt%22%3A%20%22%22%7D%7D",
      "port": 8011,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Emerging Threat] MongoDB NoSQL injection"
    },
    {
      "id": "NOSQL_REDIS_001",
      "name": "Redis EVAL command injection",
      "category": "nosql_extended",
      "subcategory": "redis",
      "payload": "EVAL \"return redis.call('GET', KEYS[1])\" 1 secret",
      "encoded": "EVAL%20%22return%20redis.call('GET'%2C%20KEYS%5B1%5D)%22%201%20secret",
      "port": 8011,
      "expected_detection": true,
      "severity": "critical",
      "expected_rule": "[NGINX Emerging Threat] Redis command injection"
    },
    {
      "id": "NOSQL_REDIS_002",
      "name": "Redis CONFIG GET disclosure",
      "category": "nosql_extended",
      "subcategory": "redis",
      "payload": "CONFIG GET *",
      "encoded": "CONFIG%20GET%20*",
      "port": 8011,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Emerging Threat] Redis command injection"
    },
    {
      "id": "NOSQL_MONGO_008",
      "name": "MongoDB Regex Injection",
      "category": "nosql_extended",
      "subcategory": "mongodb",
      "payload": "{\"$regex\":\"^admin\"}",
      "encoded": "%7B%22%24regex%22%3A%22%5Eadmin%22%7D",
      "port": 8001,
      "expected_detection": true,
      "severity": "high",
      "expected_rule": "[NGINX Emerging Threat] MongoDB NoSQL injection"
    }
  ]
}