# üöÄ Quick Start: Binary Installation

[Êó•Êú¨Ë™ûÁâà](#-„ÇØ„Ç§„ÉÉ„ÇØ„Çπ„Çø„Éº„Éà-„Éê„Ç§„Éä„É™„Çí‰ΩøÁî®„Åó„Åü„Ç§„É≥„Çπ„Éà„Éº„É´)

This guide provides the quickest way to set up the Falco nginx plugin using pre-built binaries without cloning any source code.

## üìã What This Guide Covers

- ‚úÖ nginx Web server setup
- ‚úÖ Deploying web content for attack testing
- ‚úÖ Installing Falco and nginx plugin
- ‚úÖ Testing security attack detection (SQL injection, XSS, directory traversal, etc.)
- ‚úÖ Real-time alert verification

**Time Required**: About 7 minutes
**Prerequisites**: Ubuntu 20.04+ or Debian 10+

## üì¶ Required Binary Files

To run the plugin, you need the following files:

1. **libfalco-nginx-plugin-linux-amd64.so** - Plugin binary (approx. 3.5MB)
2. **nginx_rules.yaml** - Falco detection rules (approx. 10KB)
3. **falco.yaml** - Falco configuration file (optional)

Note: After download, rename the binary to `libfalco-nginx-plugin.so` for use.

## üéØ How to Obtain Binaries

### Option 1: Download from Repository

```bash
# Download binaries directly from the repository
wget https://raw.githubusercontent.com/takaosgb3/falco-plugin-nginx/main/releases/libfalco-nginx-plugin-linux-amd64.so
wget https://raw.githubusercontent.com/takaosgb3/falco-plugin-nginx/main/releases/nginx_rules.yaml

# Verify checksum (optional)
# Note: Use curl to avoid GitHub CDN cache issues
curl -s https://raw.githubusercontent.com/takaosgb3/falco-plugin-nginx/main/releases/libfalco-nginx-plugin-linux-amd64.so.sha256 -o libfalco-nginx-plugin-linux-amd64.so.sha256
sha256sum -c libfalco-nginx-plugin-linux-amd64.so.sha256

# Rename to a convenient name
mv libfalco-nginx-plugin-linux-amd64.so libfalco-nginx-plugin.so
```

### Option 2: Direct Binary Provision

Obtain the following files from the developer:
- `libfalco-nginx-plugin-linux-amd64.so` (for Linux x86_64)
- `nginx_rules.yaml`

## ‚ö° 5-Minute Setup

### 1. Environment Preparation (1 minute)

```bash
# Create working directory
mkdir -p ~/falco-nginx-test
cd ~/falco-nginx-test

# Update system
sudo apt update
```

### 2. nginx Installation and Configuration (2 minutes)

```bash
# Install nginx
sudo apt install -y nginx

# Basic nginx configuration
sudo tee /etc/nginx/sites-available/test-site << 'EOF'
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /var/www/test-site;
    index index.html index.php;

    server_name _;

    # Log configuration (monitored by Falco plugin)
    access_log /var/log/nginx/access.log combined;
    error_log /var/log/nginx/error.log;

    location / {
        try_files $uri $uri/ =404;
    }

    # PHP file processing (for attack testing)
    location ~ \.php$ {
        # Logs are recorded even without PHP
        try_files $uri =404;
    }

    # Admin area (for brute force testing)
    location /admin {
        try_files $uri $uri/ /admin.html;
    }
}
EOF

# Enable site
sudo rm -f /etc/nginx/sites-enabled/default
sudo ln -s /etc/nginx/sites-available/test-site /etc/nginx/sites-enabled/

# Create web content directory
sudo mkdir -p /var/www/test-site
```

### 3. Preparing Web Content for Attack Testing (1 minute)

```bash
# Basic index.html
sudo tee /var/www/test-site/index.html << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>Falco Nginx Plugin Test Site</title>
</head>
<body>
    <h1>Welcome to Test Site</h1>
    <p>This site is designed for security testing with Falco nginx plugin.</p>
    <ul>
        <li><a href="/admin/">Admin Area</a></li>
        <li><a href="/api/users.php">User API</a></li>
        <li><a href="/search.php">Search</a></li>
        <li><a href="/upload.php">File Upload</a></li>
    </ul>
</body>
</html>
EOF

# Admin page (for brute force testing)
sudo mkdir -p /var/www/test-site/admin
sudo tee /var/www/test-site/admin/index.html << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>Admin Login</title>
</head>
<body>
    <h1>Administrator Login</h1>
    <form method="POST" action="/admin/login.php">
        <input type="text" name="username" placeholder="Username"><br>
        <input type="password" name="password" placeholder="Password"><br>
        <input type="submit" value="Login">
    </form>
</body>
</html>
EOF

# Search page (for SQL injection testing)
sudo tee /var/www/test-site/search.php << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>Search</title>
</head>
<body>
    <h1>Product Search</h1>
    <form method="GET">
        <input type="text" name="q" placeholder="Search products...">
        <input type="submit" value="Search">
    </form>
    <?php
    // This file doesn't actually run, but nginx logs the access
    if (isset($_GET['q'])) {
        echo "<p>Searching for: " . htmlspecialchars($_GET['q']) . "</p>";
    }
    ?>
</body>
</html>
EOF

# API endpoint (for various attack tests)
sudo mkdir -p /var/www/test-site/api
sudo tee /var/www/test-site/api/users.php << 'EOF'
<?php
// No actual PHP processing needed. nginx logging the request is sufficient
header('Content-Type: application/json');
echo json_encode(['status' => 'ok', 'users' => []]);
?>
EOF

# File upload page (for directory traversal testing)
sudo tee /var/www/test-site/upload.php << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>File Upload</title>
</head>
<body>
    <h1>File Upload</h1>
    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="file">
        <input type="submit" value="Upload">
    </form>
</body>
</html>
EOF

# Set file permissions
sudo chown -R www-data:www-data /var/www/test-site
sudo chmod -R 755 /var/www/test-site

# Restart nginx
sudo systemctl restart nginx

# Verify operation
curl -s http://localhost/ | grep -q "Welcome to Test Site" && echo "‚úÖ Site is working properly" || echo "‚ùå Cannot access site"
```

### 4. Falco Installation (2 minutes)

**Important**: 
- For Falco 0.36.0 and later, use `rules_files` (plural) instead of `rules_file` in configuration.
- The current plugin binary has been completely rewritten using the Falco Plugin SDK for Go.
- Uses API version 3.11.0, optimized for Falco 0.41.3 compatibility.
- Plugin events are identified by `source` attribute, so rules must include `source: nginx`.
- **Critical**: Rules file must be installed in `/etc/falco/rules.d/` or Falco won't detect any attacks!

```bash
# Install prerequisites (optional, not needed for Modern eBPF driver)
sudo apt install -y dialog

# Add Falco repository
curl -fsSL https://falco.org/repo/falcosecurity-packages.asc | \
  sudo gpg --dearmor -o /usr/share/keyrings/falco-archive-keyring.gpg

echo "deb [signed-by=/usr/share/keyrings/falco-archive-keyring.gpg] https://download.falco.org/packages/deb stable main" | \
  sudo tee -a /etc/apt/sources.list.d/falcosecurity.list

# Update and install Falco
sudo apt update
sudo apt install -y falco

# For non-interactive installation (recommended for automation):
# FALCO_FRONTEND=noninteractive sudo apt install -y falco
```

### 5. Plugin Deployment (30 seconds)

```bash
# Create plugin directory
sudo mkdir -p /usr/share/falco/plugins

# Deploy binary (assuming file is available)
sudo cp libfalco-nginx-plugin.so /usr/share/falco/plugins/
sudo chmod 644 /usr/share/falco/plugins/libfalco-nginx-plugin.so

# Deploy rules file (CRITICAL STEP!)
sudo mkdir -p /etc/falco/rules.d
sudo cp nginx_rules.yaml /etc/falco/rules.d/

# Verify rules file is in place
sudo ls -la /etc/falco/rules.d/nginx_rules.yaml
```

### 6. Minimal Configuration (30 seconds)

```bash
# Create complete Falco configuration (don't append)
sudo tee /etc/falco/falco.yaml << 'EOF'
# Use the new plural form for Falco 0.36.0+
rules_files:
  - /etc/falco/falco_rules.yaml
  - /etc/falco/rules.d

json_output: true
json_include_output_property: true
log_level: info

engine:
  kind: modern_ebpf

load_plugins: [nginx]

plugins:
  - name: nginx
    library_path: /usr/share/falco/plugins/libfalco-nginx-plugin.so
    init_config:
      log_paths:
        - /var/log/nginx/access.log
EOF

# Verify Falco service is running
sudo systemctl status falco-bpf.service || sudo systemctl status falco

# Restart Falco
sudo systemctl restart falco-bpf.service || sudo systemctl restart falco
```

## ‚úÖ Operation Verification and Attack Testing

### Basic Operation Check
```bash
# Check Falco startup
sudo systemctl status falco --no-pager

# Check plugin loading
sudo falco --list-plugins | grep nginx

# Start log monitoring (run in separate terminal)
sudo journalctl -u falco -f
```

### Running Attack Tests

#### 1. SQL Injection Attack
```bash
# Basic SQL injection
curl "http://localhost/search.php?q=' OR '1'='1"
curl "http://localhost/api/users.php?id=1' UNION SELECT * FROM users--"
curl "http://localhost/search.php?q='; DROP TABLE users;--"

# Encoded attacks
curl "http://localhost/search.php?q=%27%20OR%20%271%27%3D%271"
```

#### 2. XSS Attack
```bash
# Basic XSS
curl "http://localhost/search.php?q=<script>alert('XSS')</script>"
curl "http://localhost/search.php?q=<img src=x onerror=alert(1)>"

# Encoded XSS
curl "http://localhost/search.php?q=%3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E"
```

#### 3. Directory Traversal Attack
```bash
# Path traversal
curl "http://localhost/upload.php?file=../../../../../../etc/passwd"
curl "http://localhost/api/users.php?path=../../../config/database.yml"

# Encoded attacks
curl "http://localhost/upload.php?file=..%2F..%2F..%2Fetc%2Fpasswd"
```

#### 4. Command Injection Attack
```bash
# Command execution attempts
curl "http://localhost/api/users.php?cmd=; cat /etc/passwd"
curl "http://localhost/search.php?q=test; whoami"
curl "http://localhost/api/users.php?action=test|id"
```

#### 5. Brute Force Attack Simulation
```bash
# Consecutive login attempts
for i in {1..10}; do
    curl -X POST "http://localhost/admin/login.php" \
         -d "username=admin&password=password$i"
    sleep 0.1
done
```

#### 6. Scanner Detection
```bash
# Common scanner User-Agents
curl -H "User-Agent: sqlmap/1.5.2" "http://localhost/"
curl -H "User-Agent: Nikto/2.1.5" "http://localhost/"
curl -H "User-Agent: nmap scripting engine" "http://localhost/"
```

### How to Check Alerts
```bash
# Check alerts in real-time
sudo journalctl -u falco -f | grep -E "SQL injection|XSS|Directory traversal|Command injection|Brute force|Scanner"

# Search past alerts
sudo journalctl -u falco --since "5 minutes ago" | grep "CRITICAL"

# Alert statistics
sudo journalctl -u falco --since "1 hour ago" | grep -c "priority=CRITICAL"
```

## üìä Complete Configuration File Example

If nginx_rules.yaml is not available, create the following comprehensive rules file:

**Important: SDK-based plugins require `source: nginx` in all rules**

```bash
sudo tee /etc/falco/rules.d/nginx_rules.yaml << 'EOF'
- required_plugin_versions:
  - name: nginx
    version: 0.1.0

# SQL injection detection
- rule: SQL Injection Attempt
  desc: Detects various SQL injection patterns
  source: nginx
  condition: >
    nginx.path contains "' OR" or
    nginx.path contains "\" OR" or
    nginx.path contains "UNION SELECT" or
    nginx.path contains "'; DROP" or
    nginx.path contains "--" or
    nginx.query_string contains "' OR" or
    nginx.query_string contains "UNION SELECT"
  output: "SQL injection detected (client=%nginx.remote_addr method=%nginx.method path=%nginx.path query=%nginx.query_string)"
  priority: CRITICAL
  tags: [attack, sql_injection]

# XSS attack detection
- rule: XSS Attack Attempt
  desc: Detects cross-site scripting attempts
  source: nginx
  condition: >
    nginx.path contains "<script" or
    nginx.path contains "</script>" or
    nginx.path contains "javascript:" or
    nginx.query_string contains "<script" or
    nginx.query_string contains "onerror=" or
    nginx.query_string contains "onload="
  output: "XSS attack detected (client=%nginx.remote_addr path=%nginx.path query=%nginx.query_string)"
  priority: CRITICAL
  tags: [attack, xss]

# Directory traversal detection
- rule: Directory Traversal Attempt
  desc: Detects path traversal attacks
  source: nginx
  condition: >
    nginx.path contains "../" or
    nginx.path contains "..%2F" or
    nginx.path contains "..%5C" or
    nginx.path contains "/etc/passwd" or
    nginx.query_string contains "../" or
    nginx.query_string contains "..%2F"
  output: "Directory traversal detected (client=%nginx.remote_addr path=%nginx.path query=%nginx.query_string)"
  priority: CRITICAL
  tags: [attack, path_traversal]

# Command injection detection
- rule: Command Injection Attempt
  desc: Detects command injection patterns
  source: nginx
  condition: >
    (nginx.path contains ";" or nginx.query_string contains ";") and 
    (nginx.path contains "cat " or nginx.query_string contains "cat ") or
    (nginx.path contains "|" or nginx.query_string contains "|") and
    (nginx.path contains "id" or nginx.query_string contains "id") or
    nginx.query_string contains "`" or
    nginx.query_string contains "$(" or
    nginx.query_string contains "${"
  output: "Command injection detected (client=%nginx.remote_addr path=%nginx.path query=%nginx.query_string)"
  priority: CRITICAL
  tags: [attack, command_injection]

# Scanner detection
- rule: Security Scanner Detected
  desc: Detects common security scanning tools
  source: nginx
  condition: >
    nginx.user_agent contains "sqlmap" or
    nginx.user_agent contains "nikto" or
    nginx.user_agent contains "nmap" or
    nginx.user_agent contains "masscan" or
    nginx.user_agent contains "w3af" or
    nginx.user_agent contains "burp"
  output: "Security scanner detected (client=%nginx.remote_addr scanner=%nginx.user_agent path=%nginx.path)"
  priority: WARNING
  tags: [scanner, reconnaissance]

# Brute force detection (multiple requests from same IP in short time)
- rule: Potential Brute Force Attack
  desc: Multiple failed login attempts
  source: nginx
  condition: >
    nginx.path contains "/admin" and
    nginx.method = "POST" and
    nginx.status >= 400 and nginx.status < 500
  output: "Potential brute force attack (client=%nginx.remote_addr path=%nginx.path status=%nginx.status)"
  priority: WARNING
  tags: [attack, brute_force]
EOF
```

## üÜò Troubleshooting

### No Alerts Appearing

If you're not seeing any alerts after running attack tests:

1. **Check if rules file is installed:**
   ```bash
   sudo ls -la /etc/falco/rules.d/nginx_rules.yaml
   # If missing, copy it:
   sudo cp nginx_rules.yaml /etc/falco/rules.d/
   ```

2. **Check Falco service status:**
   ```bash
   sudo systemctl status falco-bpf.service
   # If failed, check logs:
   sudo journalctl -u falco-bpf.service -n 50
   ```

3. **Verify plugin is loaded:**
   ```bash
   sudo journalctl -u falco-bpf.service | grep "Loading plugin 'nginx'"
   ```

4. **Test Falco manually to see errors:**
   ```bash
   sudo /usr/bin/falco -o engine.kind=ebpf -o log_level=info 2>&1 | head -20
   ```

### Falco Installation Issues

If the Falco installation fails:

```bash
# Check if the repository was added correctly
ls -la /etc/apt/sources.list.d/falcosecurity.list

# If the file path was incorrect, remove and re-add:
sudo rm -f /etc/falco/apt/sources.list.d/falcosecurity.list
sudo rm -f /etc/apt/sources.list.d/falcosecurity.list

# Re-add the repository with correct path
echo "deb [signed-by=/usr/share/keyrings/falco-archive-keyring.gpg] https://download.falco.org/packages/deb stable main" | \
  sudo tee -a /etc/apt/sources.list.d/falcosecurity.list

# Update and install
sudo apt update
sudo apt install -y falco
```

### If Binary Not Found

```bash
# Check file existence
ls -la /usr/share/falco/plugins/libfalco-nginx-plugin.so

# Check if plugin is loaded
sudo falco --list-plugins | grep nginx
```

### If Logs Cannot Be Read

```bash
# Check nginx log permissions
ls -la /var/log/nginx/access.log

# Grant permissions to Falco user
sudo usermod -a -G adm falco
sudo systemctl restart falco
```

## üéØ Attack Testing Summary

### Expected Results
If properly set up, the following attacks can be detected:

| Attack Type | Test Command Example | Expected Alert |
|------------|---------------------|----------------|
| SQL Injection | `curl "http://localhost/search.php?q=' OR '1'='1"` | "SQL injection detected" |
| XSS | `curl "http://localhost/search.php?q=<script>alert(1)</script>"` | "XSS attack detected" |
| Directory Traversal | `curl "http://localhost/upload.php?file=../../etc/passwd"` | "Directory traversal detected" |
| Command Injection | `curl "http://localhost/api/users.php?cmd=;whoami"` | "Command injection detected" |
| Scanner | `curl -H "User-Agent: sqlmap" http://localhost/` | "Security scanner detected" |

### One-liner for Testing
```bash
# Test all attack types at once
for attack in \
  "search.php?q=' OR '1'='1" \
  "search.php?q=<script>alert(1)</script>" \
  "upload.php?file=../../etc/passwd" \
  "api/users.php?cmd=;whoami"; do
  echo "Testing: $attack"
  curl -s "http://localhost/$attack"
  sleep 1
done

# Check results
sudo journalctl -u falco --since "2 minutes ago" | grep -E "CRITICAL|WARNING"
```

## üìù Next Steps

1. **Advanced Configuration**
   - Creating custom rules
   - Performance tuning
   - Alert notification setup

2. **Production Deployment**
   - Log rotation configuration
   - Metrics collection
   - Dashboard building

3. **Detailed Documentation**
   - [Complete Setup Guide](./LOCAL_TEST_ENVIRONMENT_GUIDE.md)
   - [Troubleshooting Guide](./TROUBLESHOOTING.md)
   - [Falco Rule Creation Guide](../development/FALCO_RULES_GUIDE.md)

---

**Time Required**: About 7 minutes (including web content preparation)
**Difficulty**: Beginner
**Last Updated**: 2025-08-04

---

# üöÄ „ÇØ„Ç§„ÉÉ„ÇØ„Çπ„Çø„Éº„Éà: „Éê„Ç§„Éä„É™„Çí‰ΩøÁî®„Åó„Åü„Ç§„É≥„Çπ„Éà„Éº„É´

[English](#-quick-start-binary-installation)

„Åì„ÅÆ„Ç¨„Ç§„Éâ„Åß„ÅØ„ÄÅ„ÇΩ„Éº„Çπ„Ç≥„Éº„Éâ„Çí„ÇØ„É≠„Éº„É≥„Åõ„Åö„Å´„ÄÅ„Éì„É´„ÉâÊ∏à„Åø„Éê„Ç§„Éä„É™„Çí‰ΩøÁî®„Åó„Å¶Falco nginx„Éó„É©„Ç∞„Ç§„É≥„ÇíÊúÄ„ÇÇËøÖÈÄü„Å´„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó„Åô„ÇãÊñπÊ≥ï„ÇíË™¨Êòé„Åó„Åæ„Åô„ÄÇ

## üìã „Åì„ÅÆ„Ç¨„Ç§„Éâ„Åß„Åß„Åç„Çã„Åì„Å®

- ‚úÖ nginx Web„Çµ„Éº„Éê„Éº„ÅÆ„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
- ‚úÖ ÊîªÊíÉ„ÉÜ„Çπ„ÉàÁî®„ÅÆWeb„Ç≥„É≥„ÉÜ„É≥„ÉÑÈÖçÂÇô
- ‚úÖ Falco„Å®nginx„Éó„É©„Ç∞„Ç§„É≥„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´
- ‚úÖ „Çª„Ç≠„É•„É™„ÉÜ„Ç£ÊîªÊíÉ„ÅÆÊ§úÂá∫„ÉÜ„Çπ„ÉàÔºàSQLÊ≥®ÂÖ•„ÄÅXSS„ÄÅ„Éá„Ç£„É¨„ÇØ„Éà„É™„Éà„É©„Éê„Éº„Çµ„É´Á≠âÔºâ
- ‚úÖ „É™„Ç¢„É´„Çø„Ç§„É†„Ç¢„É©„Éº„Éà„ÅÆÁ¢∫Ë™ç

**ÊâÄË¶ÅÊôÇÈñì**: Á¥Ñ7ÂàÜ
**ÂâçÊèêÊù°‰ª∂**: Ubuntu 20.04+ „Åæ„Åü„ÅØ Debian 10+

## üì¶ ÂøÖË¶Å„Å™„Éê„Ç§„Éä„É™„Éï„Ç°„Ç§„É´

„Éó„É©„Ç∞„Ç§„É≥„ÇíÂãï‰Ωú„Åï„Åõ„Çã„Å´„ÅØ„ÄÅ‰ª•‰∏ã„ÅÆ„Éï„Ç°„Ç§„É´„ÅåÂøÖË¶Å„Åß„ÅôÔºö

1. **libfalco-nginx-plugin-linux-amd64.so** - „Éó„É©„Ç∞„Ç§„É≥Êú¨‰ΩìÔºàÁ¥Ñ3.5MBÔºâ
2. **nginx_rules.yaml** - FalcoÊ§úÂá∫„É´„Éº„É´ÔºàÁ¥Ñ10KBÔºâ
3. **falco.yaml** - FalcoË®≠ÂÆö„Éï„Ç°„Ç§„É´Ôºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ

Ê≥®: „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂæå„ÄÅ„Éê„Ç§„Éä„É™„ÅØ `libfalco-nginx-plugin.so` „Å´„É™„Éç„Éº„É†„Åó„Å¶‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ

## üéØ „Éê„Ç§„Éä„É™„ÅÆÂÖ•ÊâãÊñπÊ≥ï

### „Ç™„Éó„Ç∑„Éß„É≥1: „É™„Éù„Ç∏„Éà„É™„Åã„Çâ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ

```bash
# „É™„Éù„Ç∏„Éà„É™„Åã„ÇâÁõ¥Êé•„Éê„Ç§„Éä„É™„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
wget https://raw.githubusercontent.com/takaosgb3/falco-plugin-nginx/main/releases/libfalco-nginx-plugin-linux-amd64.so
wget https://raw.githubusercontent.com/takaosgb3/falco-plugin-nginx/main/releases/nginx_rules.yaml

# „ÉÅ„Çß„ÉÉ„ÇØ„Çµ„É†„ÇíÁ¢∫Ë™çÔºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ
# Ê≥®: GitHub CDN„Ç≠„É£„ÉÉ„Ç∑„É•ÂïèÈ°å„ÇíÂõûÈÅø„Åô„Çã„Åü„ÇÅcurl„Çí‰ΩøÁî®
curl -s https://raw.githubusercontent.com/takaosgb3/falco-plugin-nginx/main/releases/libfalco-nginx-plugin-linux-amd64.so.sha256 -o libfalco-nginx-plugin-linux-amd64.so.sha256
sha256sum -c libfalco-nginx-plugin-linux-amd64.so.sha256

# ‰Ωø„ÅÑ„ÇÑ„Åô„ÅÑÂêçÂâç„Å´„É™„Éç„Éº„É†
mv libfalco-nginx-plugin-linux-amd64.so libfalco-nginx-plugin.so
```

### „Ç™„Éó„Ç∑„Éß„É≥2: „Éì„É´„ÉâÊ∏à„Åø„Éê„Ç§„Éä„É™„ÅÆÁõ¥Êé•Êèê‰æõ

ÈñãÁô∫ËÄÖ„Åã„Çâ‰ª•‰∏ã„ÅÆ„Éï„Ç°„Ç§„É´„ÇíÂèó„ÅëÂèñ„Å£„Å¶„Åè„Å†„Åï„ÅÑÔºö
- `libfalco-nginx-plugin-linux-amd64.so` (Linux x86_64Áî®)
- `nginx_rules.yaml`

## ‚ö° 5ÂàÜ„Åß„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó

### 1. Áí∞Â¢ÉÊ∫ñÂÇôÔºà1ÂàÜÔºâ

```bash
# ‰ΩúÊ•≠„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê
mkdir -p ~/falco-nginx-test
cd ~/falco-nginx-test

# „Ç∑„Çπ„ÉÜ„É†Êõ¥Êñ∞
sudo apt update
```

### 2. nginx„Ç§„É≥„Çπ„Éà„Éº„É´„Å®Ë®≠ÂÆöÔºà2ÂàÜÔºâ

```bash
# nginx„Çí„Ç§„É≥„Çπ„Éà„Éº„É´
sudo apt install -y nginx

# nginx„ÅÆÂü∫Êú¨Ë®≠ÂÆö
sudo tee /etc/nginx/sites-available/test-site << 'EOF'
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /var/www/test-site;
    index index.html index.php;

    server_name _;

    # „É≠„Ç∞Ë®≠ÂÆöÔºàFalco„Éó„É©„Ç∞„Ç§„É≥„ÅåÁõ£Ë¶ñÔºâ
    access_log /var/log/nginx/access.log combined;
    error_log /var/log/nginx/error.log;

    location / {
        try_files $uri $uri/ =404;
    }

    # PHP„Éï„Ç°„Ç§„É´„ÅÆÂá¶ÁêÜÔºàÊîªÊíÉ„ÉÜ„Çπ„ÉàÁî®Ôºâ
    location ~ \.php$ {
        # PHP„ÅåÁÑ°„Åè„Å¶„ÇÇ„É≠„Ç∞„ÅØË®òÈå≤„Åï„Çå„Çã
        try_files $uri =404;
    }

    # ÁÆ°ÁêÜËÄÖ„Ç®„É™„Ç¢Ôºà„Éñ„É´„Éº„Éà„Éï„Ç©„Éº„Çπ„ÉÜ„Çπ„ÉàÁî®Ôºâ
    location /admin {
        try_files $uri $uri/ /admin.html;
    }
}
EOF

# „Çµ„Ç§„Éà„ÇíÊúâÂäπÂåñ
sudo rm -f /etc/nginx/sites-enabled/default
sudo ln -s /etc/nginx/sites-available/test-site /etc/nginx/sites-enabled/

# Web„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê
sudo mkdir -p /var/www/test-site
```

### 3. ÊîªÊíÉ„ÉÜ„Çπ„ÉàÁî®Web„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅÆÊ∫ñÂÇôÔºà1ÂàÜÔºâ

```bash
# Âü∫Êú¨ÁöÑ„Å™index.html
sudo tee /var/www/test-site/index.html << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>Falco Nginx Plugin Test Site</title>
</head>
<body>
    <h1>Welcome to Test Site</h1>
    <p>This site is designed for security testing with Falco nginx plugin.</p>
    <ul>
        <li><a href="/admin/">Admin Area</a></li>
        <li><a href="/api/users.php">User API</a></li>
        <li><a href="/search.php">Search</a></li>
        <li><a href="/upload.php">File Upload</a></li>
    </ul>
</body>
</html>
EOF

# ÁÆ°ÁêÜËÄÖ„Éö„Éº„Ç∏Ôºà„Éñ„É´„Éº„Éà„Éï„Ç©„Éº„Çπ„ÉÜ„Çπ„ÉàÁî®Ôºâ
sudo mkdir -p /var/www/test-site/admin
sudo tee /var/www/test-site/admin/index.html << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>Admin Login</title>
</head>
<body>
    <h1>Administrator Login</h1>
    <form method="POST" action="/admin/login.php">
        <input type="text" name="username" placeholder="Username"><br>
        <input type="password" name="password" placeholder="Password"><br>
        <input type="submit" value="Login">
    </form>
</body>
</html>
EOF

# Ê§úÁ¥¢„Éö„Éº„Ç∏ÔºàSQL„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥„ÉÜ„Çπ„ÉàÁî®Ôºâ
sudo tee /var/www/test-site/search.php << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>Search</title>
</head>
<body>
    <h1>Product Search</h1>
    <form method="GET">
        <input type="text" name="q" placeholder="Search products...">
        <input type="submit" value="Search">
    </form>
    <?php
    // „Åì„ÅÆ„Éï„Ç°„Ç§„É´„ÅØÂÆüÈöõ„Å´„ÅØÂãï‰Ωú„Åó„Åæ„Åõ„Çì„Åå„ÄÅnginx„ÅØ„Ç¢„ÇØ„Çª„Çπ„É≠„Ç∞„ÇíË®òÈå≤„Åó„Åæ„Åô
    if (isset($_GET['q'])) {
        echo "<p>Searching for: " . htmlspecialchars($_GET['q']) . "</p>";
    }
    ?>
</body>
</html>
EOF

# API„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÔºàÊßò„ÄÖ„Å™ÊîªÊíÉ„ÉÜ„Çπ„ÉàÁî®Ôºâ
sudo mkdir -p /var/www/test-site/api
sudo tee /var/www/test-site/api/users.php << 'EOF'
<?php
// ÂÆüÈöõ„ÅÆPHPÂá¶ÁêÜ„ÅØ‰∏çË¶Å„ÄÇnginx„Åå„É™„ÇØ„Ç®„Çπ„Éà„Çí„É≠„Ç∞„Å´Ë®òÈå≤„Åô„Çã„Å†„Åë„ÅßÂçÅÂàÜ
header('Content-Type: application/json');
echo json_encode(['status' => 'ok', 'users' => []]);
?>
EOF

# „Éï„Ç°„Ç§„É´„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Éö„Éº„Ç∏Ôºà„Éá„Ç£„É¨„ÇØ„Éà„É™„Éà„É©„Éê„Éº„Çµ„É´„ÉÜ„Çπ„ÉàÁî®Ôºâ
sudo tee /var/www/test-site/upload.php << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>File Upload</title>
</head>
<body>
    <h1>File Upload</h1>
    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="file">
        <input type="submit" value="Upload">
    </form>
</body>
</html>
EOF

# „Éï„Ç°„Ç§„É´Ê®©ÈôêË®≠ÂÆö
sudo chown -R www-data:www-data /var/www/test-site
sudo chmod -R 755 /var/www/test-site

# nginxÂÜçËµ∑Âãï
sudo systemctl restart nginx

# Âãï‰ΩúÁ¢∫Ë™ç
curl -s http://localhost/ | grep -q "Welcome to Test Site" && echo "‚úÖ „Çµ„Ç§„Éà„ÅåÊ≠£Â∏∏„Å´Âãï‰Ωú„Åó„Å¶„ÅÑ„Åæ„Åô" || echo "‚ùå „Çµ„Ç§„Éà„Å´„Ç¢„ÇØ„Çª„Çπ„Åß„Åç„Åæ„Åõ„Çì"
```

### 4. Falco„Ç§„É≥„Çπ„Éà„Éº„É´Ôºà2ÂàÜÔºâ

**ÈáçË¶Å**: 
- Falco 0.36.0‰ª•Èôç„Åß„ÅØ„ÄÅË®≠ÂÆö„Åß`rules_file`„ÅÆ‰ª£„Çè„Çä„Å´`rules_files`ÔºàË§áÊï∞ÂΩ¢Ôºâ„Çí‰ΩøÁî®„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
- ÁèæÂú®„ÅÆ„Éó„É©„Ç∞„Ç§„É≥„Éê„Ç§„Éä„É™„ÅØFalco Plugin SDK for Go„Çí‰ΩøÁî®„Åó„Å¶ÂÆåÂÖ®„Å´Êõ∏„ÅçÁõ¥„Åï„Çå„Åæ„Åó„Åü„ÄÇ
- API„Éê„Éº„Ç∏„Éß„É≥3.11.0„Çí‰ΩøÁî®„Åó„ÄÅFalco 0.41.3„Å®„ÅÆ‰∫íÊèõÊÄß„Å´ÊúÄÈÅ©Âåñ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ
- „Éó„É©„Ç∞„Ç§„É≥„Ç§„Éô„É≥„Éà„ÅØ`source`Â±ûÊÄß„ÅßË≠òÂà•„Åï„Çå„Çã„Åü„ÇÅ„ÄÅ„É´„Éº„É´„Å´`source: nginx`„ÇíÂê´„ÇÅ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
- **ÂøÖÈ†à**: „É´„Éº„É´„Éï„Ç°„Ç§„É´„Çí`/etc/falco/rules.d/`„Å´„Ç§„É≥„Çπ„Éà„Éº„É´„Åó„Å™„ÅÑ„Å®ÊîªÊíÉ„ÇíÊ§úÂá∫„Åß„Åç„Åæ„Åõ„ÇìÔºÅ

```bash
# ÂâçÊèêÊù°‰ª∂„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´Ôºà„Ç™„Éó„Ç∑„Éß„É≥„ÄÅModern eBPF„Éâ„É©„Ç§„Éê„Éº„Å´„ÅØ‰∏çË¶ÅÔºâ
sudo apt install -y dialog

# Falco„É™„Éù„Ç∏„Éà„É™ËøΩÂä†
curl -fsSL https://falco.org/repo/falcosecurity-packages.asc | \
  sudo gpg --dearmor -o /usr/share/keyrings/falco-archive-keyring.gpg

echo "deb [signed-by=/usr/share/keyrings/falco-archive-keyring.gpg] https://download.falco.org/packages/deb stable main" | \
  sudo tee -a /etc/apt/sources.list.d/falcosecurity.list

# Êõ¥Êñ∞„Å®Falco„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´
sudo apt update
sudo apt install -y falco

# ÈùûÂØæË©±Âûã„Ç§„É≥„Çπ„Éà„Éº„É´ÔºàËá™ÂãïÂåñ„Å´Êé®Â•®ÔºâÔºö
# FALCO_FRONTEND=noninteractive sudo apt install -y falco
```

### 5. „Éó„É©„Ç∞„Ç§„É≥ÈÖçÁΩÆÔºà30ÁßíÔºâ

```bash
# „Éó„É©„Ç∞„Ç§„É≥„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê
sudo mkdir -p /usr/share/falco/plugins

# „Éê„Ç§„Éä„É™„ÇíÈÖçÁΩÆÔºà„Éï„Ç°„Ç§„É´„ÅåÊâãÂÖÉ„Å´„ÅÇ„ÇãÂâçÊèêÔºâ
sudo cp libfalco-nginx-plugin.so /usr/share/falco/plugins/
sudo chmod 644 /usr/share/falco/plugins/libfalco-nginx-plugin.so

# „É´„Éº„É´„Éï„Ç°„Ç§„É´„ÇíÈÖçÁΩÆÔºàÂøÖÈ†à„Çπ„ÉÜ„ÉÉ„ÉóÔºÅÔºâ
sudo mkdir -p /etc/falco/rules.d
sudo cp nginx_rules.yaml /etc/falco/rules.d/

# „É´„Éº„É´„Éï„Ç°„Ç§„É´„ÅåÊ≠£„Åó„ÅèÈÖçÁΩÆ„Åï„Çå„Åü„ÅãÁ¢∫Ë™ç
sudo ls -la /etc/falco/rules.d/nginx_rules.yaml
```

### 6. ÊúÄÂ∞èÈôê„ÅÆË®≠ÂÆöÔºà30ÁßíÔºâ

```bash
# ÂÆåÂÖ®„Å™FalcoË®≠ÂÆö„Çí‰ΩúÊàêÔºàËøΩË®ò„Åß„ÅØ„Å™„ÅèÊñ∞Ë¶è‰ΩúÊàêÔºâ
sudo tee /etc/falco/falco.yaml << 'EOF'
# Falco 0.36.0‰ª•ÈôçÁî®„ÅÆÊñ∞„Åó„ÅÑË§áÊï∞ÂΩ¢„Çí‰ΩøÁî®
rules_files:
  - /etc/falco/falco_rules.yaml
  - /etc/falco/rules.d

json_output: true
json_include_output_property: true
log_level: info

engine:
  kind: modern_ebpf

load_plugins: [nginx]

plugins:
  - name: nginx
    library_path: /usr/share/falco/plugins/libfalco-nginx-plugin.so
    init_config:
      log_paths:
        - /var/log/nginx/access.log
EOF

# Falco„Çµ„Éº„Éì„Çπ„ÅåÂÆüË°å‰∏≠„ÅãÁ¢∫Ë™ç
sudo systemctl status falco-bpf.service || sudo systemctl status falco

# FalcoÂÜçËµ∑Âãï
sudo systemctl restart falco-bpf.service || sudo systemctl restart falco
```

## ‚úÖ Âãï‰ΩúÁ¢∫Ë™ç„Å®ÊîªÊíÉ„ÉÜ„Çπ„Éà

### Âü∫Êú¨ÁöÑ„Å™Âãï‰ΩúÁ¢∫Ë™ç
```bash
# Falco„ÅÆËµ∑ÂãïÁ¢∫Ë™ç
sudo systemctl status falco --no-pager

# „Éó„É©„Ç∞„Ç§„É≥„ÅÆ„É≠„Éº„ÉâÁ¢∫Ë™ç
sudo falco --list-plugins | grep nginx

# „É≠„Ç∞Áõ£Ë¶ñÈñãÂßãÔºàÂà•„Çø„Éº„Éü„Éä„É´„ÅßÂÆüË°åÔºâ
sudo journalctl -u falco -f
```

### ÊîªÊíÉ„ÉÜ„Çπ„Éà„ÅÆÂÆüË°å

#### 1. SQL„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥ÊîªÊíÉ
```bash
# Âü∫Êú¨ÁöÑ„Å™SQL„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥
curl "http://localhost/search.php?q=' OR '1'='1"
curl "http://localhost/api/users.php?id=1' UNION SELECT * FROM users--"
curl "http://localhost/search.php?q='; DROP TABLE users;--"

# „Ç®„É≥„Ç≥„Éº„Éâ„Åï„Çå„ÅüÊîªÊíÉ
curl "http://localhost/search.php?q=%27%20OR%20%271%27%3D%271"
```

#### 2. XSSÊîªÊíÉ
```bash
# Âü∫Êú¨ÁöÑ„Å™XSS
curl "http://localhost/search.php?q=<script>alert('XSS')</script>"
curl "http://localhost/search.php?q=<img src=x onerror=alert(1)>"

# „Ç®„É≥„Ç≥„Éº„Éâ„Åï„Çå„ÅüXSS
curl "http://localhost/search.php?q=%3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E"
```

#### 3. „Éá„Ç£„É¨„ÇØ„Éà„É™„Éà„É©„Éê„Éº„Çµ„É´ÊîªÊíÉ
```bash
# „Éë„Çπ„Éà„É©„Éê„Éº„Çµ„É´
curl "http://localhost/upload.php?file=../../../../../../etc/passwd"
curl "http://localhost/api/users.php?path=../../../config/database.yml"

# „Ç®„É≥„Ç≥„Éº„Éâ„Åï„Çå„ÅüÊîªÊíÉ
curl "http://localhost/upload.php?file=..%2F..%2F..%2Fetc%2Fpasswd"
```

#### 4. „Ç≥„Éû„É≥„Éâ„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥ÊîªÊíÉ
```bash
# „Ç≥„Éû„É≥„ÉâÂÆüË°åË©¶Ë°å
curl "http://localhost/api/users.php?cmd=; cat /etc/passwd"
curl "http://localhost/search.php?q=test; whoami"
curl "http://localhost/api/users.php?action=test|id"
```

#### 5. „Éñ„É´„Éº„Éà„Éï„Ç©„Éº„ÇπÊîªÊíÉ„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
```bash
# ÈÄ£Á∂ö„Åó„Åü„É≠„Ç∞„Ç§„É≥Ë©¶Ë°å
for i in {1..10}; do
    curl -X POST "http://localhost/admin/login.php" \
         -d "username=admin&password=password$i"
    sleep 0.1
done
```

#### 6. „Çπ„Ç≠„É£„Éä„ÉºÊ§úÂá∫
```bash
# ‰∏ÄËà¨ÁöÑ„Å™„Çπ„Ç≠„É£„Éä„Éº„ÅÆUser-Agent
curl -H "User-Agent: sqlmap/1.5.2" "http://localhost/"
curl -H "User-Agent: Nikto/2.1.5" "http://localhost/"
curl -H "User-Agent: nmap scripting engine" "http://localhost/"
```

### „Ç¢„É©„Éº„ÉàÁ¢∫Ë™çÊñπÊ≥ï
```bash
# „É™„Ç¢„É´„Çø„Ç§„É†„Åß„Ç¢„É©„Éº„Éà„ÇíÁ¢∫Ë™ç
sudo journalctl -u falco -f | grep -E "SQL injection|XSS|Directory traversal|Command injection|Brute force|Scanner"

# ÈÅéÂéª„ÅÆ„Ç¢„É©„Éº„Éà„ÇíÊ§úÁ¥¢
sudo journalctl -u falco --since "5 minutes ago" | grep "CRITICAL"

# „Ç¢„É©„Éº„Éà„ÅÆÁµ±Ë®à
sudo journalctl -u falco --since "1 hour ago" | grep -c "priority=CRITICAL"
```

## üìä ÂÆåÂÖ®„Å™Ë®≠ÂÆö„Éï„Ç°„Ç§„É´‰æã

„ÇÇ„Åónginx_rules.yaml„ÅåÊâã„Å´ÂÖ•„Çâ„Å™„ÅÑÂ†¥Âêà„ÅØ„ÄÅ‰ª•‰∏ã„ÅÆÂåÖÊã¨ÁöÑ„Å™„É´„Éº„É´„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàêÔºö

**ÈáçË¶Å: SDK„Éô„Éº„Çπ„ÅÆ„Éó„É©„Ç∞„Ç§„É≥„ÅØ„ÄÅ„Åô„Åπ„Å¶„ÅÆ„É´„Éº„É´„Å´`source: nginx`„ÅåÂøÖË¶Å„Åß„Åô**

```bash
sudo tee /etc/falco/rules.d/nginx_rules.yaml << 'EOF'
- required_plugin_versions:
  - name: nginx
    version: 0.1.0

# SQL„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥Ê§úÂá∫
- rule: SQL Injection Attempt
  desc: Detects various SQL injection patterns
  source: nginx
  condition: >
    nginx.path contains "' OR" or
    nginx.path contains "\" OR" or
    nginx.path contains "UNION SELECT" or
    nginx.path contains "'; DROP" or
    nginx.path contains "--" or
    nginx.query_string contains "' OR" or
    nginx.query_string contains "UNION SELECT"
  output: "SQL injection detected (client=%nginx.remote_addr method=%nginx.method path=%nginx.path query=%nginx.query_string)"
  priority: CRITICAL
  tags: [attack, sql_injection]

# XSSÊîªÊíÉÊ§úÂá∫
- rule: XSS Attack Attempt
  desc: Detects cross-site scripting attempts
  source: nginx
  condition: >
    nginx.path contains "<script" or
    nginx.path contains "</script>" or
    nginx.path contains "javascript:" or
    nginx.query_string contains "<script" or
    nginx.query_string contains "onerror=" or
    nginx.query_string contains "onload="
  output: "XSS attack detected (client=%nginx.remote_addr path=%nginx.path query=%nginx.query_string)"
  priority: CRITICAL
  tags: [attack, xss]

# „Éá„Ç£„É¨„ÇØ„Éà„É™„Éà„É©„Éê„Éº„Çµ„É´Ê§úÂá∫
- rule: Directory Traversal Attempt
  desc: Detects path traversal attacks
  source: nginx
  condition: >
    nginx.request_uri contains "../" or
    nginx.request_uri contains "..%2F" or
    nginx.request_uri contains "..%5C" or
    nginx.request_uri contains "..\" or
    nginx.request_uri contains "/etc/passwd" or
    nginx.request_uri contains "C:\Windows"
  output: "Directory traversal detected (ip=%nginx.client_ip% uri=%nginx.request_uri%)"
  priority: CRITICAL
  tags: [attack, path_traversal]

# „Ç≥„Éû„É≥„Éâ„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥Ê§úÂá∫
- rule: Command Injection Attempt
  desc: Detects command injection patterns
  source: nginx
  condition: >
    (nginx.path contains ";" or nginx.query_string contains ";") and 
    (nginx.path contains "cat " or nginx.query_string contains "cat ") or
    (nginx.path contains "|" or nginx.query_string contains "|") and
    (nginx.path contains "id" or nginx.query_string contains "id") or
    nginx.query_string contains "`" or
    nginx.query_string contains "$(" or
    nginx.query_string contains "${"
  output: "Command injection detected (client=%nginx.remote_addr path=%nginx.path query=%nginx.query_string)"
  priority: CRITICAL
  tags: [attack, command_injection]

# „Çπ„Ç≠„É£„Éä„ÉºÊ§úÂá∫
- rule: Security Scanner Detected
  desc: Detects common security scanning tools
  source: nginx
  condition: >
    nginx.user_agent contains "sqlmap" or
    nginx.user_agent contains "nikto" or
    nginx.user_agent contains "nmap" or
    nginx.user_agent contains "masscan" or
    nginx.user_agent contains "w3af" or
    nginx.user_agent contains "burp"
  output: "Security scanner detected (client=%nginx.remote_addr scanner=%nginx.user_agent path=%nginx.path)"
  priority: WARNING
  tags: [scanner, reconnaissance]

# „Éñ„É´„Éº„Éà„Éï„Ç©„Éº„ÇπÊ§úÂá∫ÔºàÂêå‰∏ÄIP„Åã„ÇâÁü≠ÊôÇÈñì„Å´Â§öÊï∞„ÅÆ„É™„ÇØ„Ç®„Çπ„ÉàÔºâ
- rule: Potential Brute Force Attack
  desc: Multiple failed login attempts
  source: nginx
  condition: >
    nginx.path contains "/admin" and
    nginx.method = "POST" and
    nginx.status >= 400 and nginx.status < 500
  output: "Potential brute force attack (client=%nginx.remote_addr path=%nginx.path status=%nginx.status)"
  priority: WARNING
  tags: [attack, brute_force]
EOF
```

## üÜò „Éà„É©„Éñ„É´„Ç∑„É•„Éº„ÉÜ„Ç£„É≥„Ç∞

### Falco„Ç§„É≥„Çπ„Éà„Éº„É´„ÅÆÂïèÈ°å

Falco„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´„ÅåÂ§±Êïó„Åô„ÇãÂ†¥ÂêàÔºö

```bash
# „É™„Éù„Ç∏„Éà„É™„ÅåÊ≠£„Åó„ÅèËøΩÂä†„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç
ls -la /etc/apt/sources.list.d/falcosecurity.list

# „Éï„Ç°„Ç§„É´„Éë„Çπ„ÅåÈñìÈÅï„Å£„Å¶„ÅÑ„ÅüÂ†¥Âêà„ÄÅÂâäÈô§„Åó„Å¶ÂÜçËøΩÂä†Ôºö
sudo rm -f /etc/falco/apt/sources.list.d/falcosecurity.list
sudo rm -f /etc/apt/sources.list.d/falcosecurity.list

# Ê≠£„Åó„ÅÑ„Éë„Çπ„Åß„É™„Éù„Ç∏„Éà„É™„ÇíÂÜçËøΩÂä†
echo "deb [signed-by=/usr/share/keyrings/falco-archive-keyring.gpg] https://download.falco.org/packages/deb stable main" | \
  sudo tee -a /etc/apt/sources.list.d/falcosecurity.list

# Êõ¥Êñ∞„Å®„Ç§„É≥„Çπ„Éà„Éº„É´
sudo apt update
sudo apt install -y falco
```

### „Éê„Ç§„Éä„É™„ÅåË¶ã„Å§„Åã„Çâ„Å™„ÅÑÂ†¥Âêà

```bash
# „Éï„Ç°„Ç§„É´„ÅÆÂ≠òÂú®Á¢∫Ë™ç
ls -la /usr/share/falco/plugins/libfalco-nginx-plugin.so

# „Éó„É©„Ç∞„Ç§„É≥„Åå„É≠„Éº„Éâ„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç
sudo falco --list-plugins | grep nginx
```

### „É≠„Ç∞„ÅåË™≠„ÇÅ„Å™„ÅÑÂ†¥Âêà

```bash
# nginx„É≠„Ç∞„ÅÆÊ®©ÈôêÁ¢∫Ë™ç
ls -la /var/log/nginx/access.log

# Falco„É¶„Éº„Ç∂„Éº„Å´Ê®©Èôê‰ªò‰∏é
sudo usermod -a -G adm falco
sudo systemctl restart falco
```

## üéØ ÊîªÊíÉ„ÉÜ„Çπ„Éà„ÅÆ„Åæ„Å®„ÇÅ

### ÊúüÂæÖ„Åï„Çå„ÇãÁµêÊûú
Ê≠£„Åó„Åè„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó„Åï„Çå„Å¶„ÅÑ„Çå„Å∞„ÄÅ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™ÊîªÊíÉ„ÇíÊ§úÂá∫„Åß„Åç„Åæ„ÅôÔºö

| ÊîªÊíÉ„Çø„Ç§„Éó | „ÉÜ„Çπ„Éà„Ç≥„Éû„É≥„Éâ‰æã | ÊúüÂæÖ„Åï„Çå„Çã„Ç¢„É©„Éº„Éà |
|-----------|---------------|----------------|
| SQL„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥ | `curl "http://localhost/search.php?q=' OR '1'='1"` | "SQL injection detected" |
| XSS | `curl "http://localhost/search.php?q=<script>alert(1)</script>"` | "XSS attack detected" |
| „Éá„Ç£„É¨„ÇØ„Éà„É™„Éà„É©„Éê„Éº„Çµ„É´ | `curl "http://localhost/upload.php?file=../../etc/passwd"` | "Directory traversal detected" |
| „Ç≥„Éû„É≥„Éâ„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥ | `curl "http://localhost/api/users.php?cmd=;whoami"` | "Command injection detected" |
| „Çπ„Ç≠„É£„Éä„Éº | `curl -H "User-Agent: sqlmap" http://localhost/` | "Security scanner detected" |

### „ÉÜ„Çπ„ÉàÁî®„ÉØ„É≥„É©„Ç§„Éä„Éº
```bash
# „Åô„Åπ„Å¶„ÅÆÊîªÊíÉ„Çø„Ç§„Éó„Çí‰∏ÄÂ∫¶„Å´„ÉÜ„Çπ„Éà
for attack in \
  "search.php?q=' OR '1'='1" \
  "search.php?q=<script>alert(1)</script>" \
  "upload.php?file=../../etc/passwd" \
  "api/users.php?cmd=;whoami"; do
  echo "Testing: $attack"
  curl -s "http://localhost/$attack"
  sleep 1
done

# ÁµêÊûúÁ¢∫Ë™ç
sudo journalctl -u falco --since "2 minutes ago" | grep -E "CRITICAL|WARNING"
```

## üìù Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó

1. **„Çà„ÇäÈ´òÂ∫¶„Å™Ë®≠ÂÆö**
   - „Ç´„Çπ„Çø„É†„É´„Éº„É´„ÅÆ‰ΩúÊàê
   - „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÅ„É•„Éº„Éã„É≥„Ç∞
   - „Ç¢„É©„Éº„ÉàÈÄöÁü•„ÅÆË®≠ÂÆö

2. **Êú¨Áï™Áí∞Â¢É„Å∏„ÅÆÂ±ïÈñã**
   - „É≠„Ç∞„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥„ÅÆË®≠ÂÆö
   - „É°„Éà„É™„ÇØ„Çπ„ÅÆÂèéÈõÜ
   - „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÅÆÊßãÁØâ

3. **Ë©≥Á¥∞„Å™„Éâ„Ç≠„É•„É°„É≥„Éà**
   - [ÂÆåÂÖ®Áâà„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó„Ç¨„Ç§„Éâ](./LOCAL_TEST_ENVIRONMENT_GUIDE.md)
   - [„Éà„É©„Éñ„É´„Ç∑„É•„Éº„ÉÜ„Ç£„É≥„Ç∞„Ç¨„Ç§„Éâ](./TROUBLESHOOTING.md)
   - [Falco„É´„Éº„É´‰ΩúÊàê„Ç¨„Ç§„Éâ](../development/FALCO_RULES_GUIDE.md)

---

**ÊâÄË¶ÅÊôÇÈñì**: Á¥Ñ7ÂàÜÔºàWeb„Ç≥„É≥„ÉÜ„É≥„ÉÑÊ∫ñÂÇô„ÇíÂê´„ÇÄÔºâ
**Èõ£ÊòìÂ∫¶**: ÂàùÁ¥ö
**ÊúÄÁµÇÊõ¥Êñ∞**: 2025-08-04